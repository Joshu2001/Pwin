import{c as e,j as t,L as s,g as r,u as a,b as o,E as n,h as i,C as l}from"./index-Dffz9O_H.js";import{u as c,b as d,h as u}from"./vendor-Cml8jNaD.js";import{g as m,W as g}from"./config-BQFUInJh.js";import{r as h}from"./media-CRtsjh58.js";import{C as x,B as p}from"./BoostsModal-PsakSbO-.js";import{X as f}from"./x-BtVIjD1R.js";import{A as y}from"./alert-triangle-C6n8C-dl.js";import{T as b}from"./trending-up-DyyEJKTd.js";import{S as v}from"./SharedBottomBar-ftLq5vqx.js";import{S as w}from"./search-BlChXm75.js";import{C as j}from"./check-circle-2-N6Mb3lE-.js";import{C as N}from"./calendar-DprmkQut.js";import{C as k}from"./chevron-down-DUtZ1Sn5.js";import{S}from"./sparkles-F1FsclXw.js";import{C}from"./clock-CO7zGInQ.js";import{D as q}from"./dollar-sign-Dt55NhB_.js";import{F as T,P as I}from"./pencil-Dwd5jUWx.js";import{H as E}from"./heart-DAgKoHaU.js";import{M as A}from"./message-square-CNovjS0u.js";import{M as L}from"./megaphone-BUgp1_ja.js";import{C as $}from"./crown-FyEv4QQm.js";import{P as R,F as D}from"./pin-DtEqoQXO.js";import{C as _}from"./chevron-up-DLy_zouo.js";import{B}from"./bookmark-DxL_Xr1W.js";import{L as M}from"./lightbulb-Cgck_kRT.js";import{T as O,S as F}from"./trash-2-MuMVlyUY.js";import{H as z}from"./heart-off-Ccs-Hx7y.js";import{S as U}from"./share-2--6cONZ4L.js";import{U as P}from"./user-ruYZ-ydt.js";import"./home-Dd5N3dNo.js";const Y=e("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);function J({isOpen:e,onClose:a,onUpgrade:o,onClaimFree:n,selectedLanguage:i}){return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[t.jsx("button",{onClick:a,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600","aria-label":"Close",children:t.jsx(f,{size:24})}),t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:t.jsx(s,{size:32,className:"text-red-600"})})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-3",children:r("Daily Claim Limit Reached",i)}),t.jsx("p",{className:"text-gray-600 text-sm text-center mb-6",children:r("You've reached your daily limit for paid requests. This limit helps maintain quality and fair access for all creators.",i)}),t.jsx("button",{onClick:o,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg mb-3 transition-colors",children:r("Upgrade",i)}),t.jsx("button",{onClick:n,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-900 font-semibold py-3 rounded-lg transition-colors",children:r("Claim a Free Request",i)})]})}):null}function H({isOpen:e,onClose:s,onUpgrade:a,onViewLowerValue:o,selectedLanguage:n}){return e?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[t.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600","aria-label":"Close",children:t.jsx(f,{size:24})}),t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:t.jsx(y,{size:32,className:"text-yellow-600"})})}),t.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-3",children:r("Request Value Limit Reached",n)}),t.jsx("p",{className:"text-gray-600 text-sm text-center mb-6",children:r("Higher-value requests need a premium plan. Choose a lower-value request or upgrade your plan.",n)}),t.jsx("button",{onClick:a,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg mb-3 transition-colors",children:r("Upgrade",n)}),t.jsx("button",{onClick:o,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-900 font-semibold py-3 rounded-lg transition-colors",children:r("View Requests Under $150",n)})]})}):null}function V({onClose:e,onBoostRequest:s,onInviteFriends:a,nudgeRequest:o,selectedLanguage:n}){const i=o?.selectedCreator||o?.creatorId,l=o?.selectedCreatorName||o?.creatorName||"this creator";return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 relative",children:[t.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600","aria-label":"Close",children:t.jsx(f,{size:24})}),t.jsx("div",{className:"flex justify-center mb-4",children:t.jsx("div",{className:"bg-amber-100 p-3 rounded-full",children:t.jsx(b,{size:32,className:"text-amber-600"})})}),i?t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-3",children:[r("Waiting on",n)," ",l]}),t.jsxs("p",{className:"text-gray-600 text-sm text-center mb-6 leading-relaxed",children:[l," ",r("receives many requests and prioritizes paid or boosted ones",n),"."]}),t.jsx("p",{className:"text-gray-600 text-sm text-center mb-6 leading-relaxed",children:r("Boosting your request signals stronger interest and increases the chance they'll respond. You can also invite others to contribute to make your request more compelling.",n)})]}):t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 text-center mb-3",children:r("Your Request Needs a Nudge",n)}),t.jsx("p",{className:"text-gray-600 text-sm text-center mb-6 leading-relaxed",children:r("It looks like your request hasn't reached a creator yet. Free requests can get buried as new requests come in. Boosting your request increases visibility and response speed. Inviting others to contribute can also make it more attractive to creators.",n)})]}),t.jsx("button",{onClick:s,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg mb-3 transition-colors",children:r(i?"Boost":"Boost for Visibility",n)}),t.jsx("button",{onClick:a,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-900 font-semibold py-3 rounded-lg transition-colors",children:r("Invite Contributors",n)})]})})}const W={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BACKEND_URL:"https://regaarder-pwin.onrender.com"},X="var(--color-neutral-light-bg)",G=e=>h(e),Q="user-123",K="You",Z="https://placehold.co/40x40/4F46E5/ffffff?text=U",ee=[{id:3,company:"NASA Official",timeAgo:"2w ago",title:"Artemis Program: Orion Capsule Deep Dive",description:"Requesting an educational video series on the Orion capsule, covering its design, mission parameters, and future role in lunar exploration. The content must be vetted for scientific accuracy by NASA representatives and target a middle-school to high-school educational demographic.",likes:350,comments:102,boosts:88,funding:8900,isTrending:!1,isSponsored:!1,companyInitial:"N",companyColor:"bg-blue-800",imageUrl:"uploaded:1000002754.jpg-f38ae5ef-59ef-4f7d-9c73-a5a04433228a"},{id:4,company:"Global Watchdog",timeAgo:"3d ago",title:"The Lithium Trail: Investigating Sustainable Battery Sources",description:"In-depth documentary exploring the global supply chain for lithium, tracing its journey from mining to final battery assembly. The focus should be on environmental impact, ethical sourcing challenges, and potential sustainable alternatives for the future of electric power.",likes:210,comments:78,boosts:110,funding:4500,isTrending:!0,isSponsored:!1,companyInitial:"G",companyColor:"bg-green-700",imageUrl:"uploaded:1000002752.jpg-22797b9e-93d7-4f62-a5a2-42bbe6353ed5"},{id:5,company:"Cultural Archive",timeAgo:"1w ago",title:"The Silent Screen: A History of Early Cinema",description:"Seeking a rich, detailed historical investigation into the foundational years of silent film, covering key technological innovations, the rise of the star system, and its cultural impact before the advent of sound. Requires archival footage and expert interviews.",likes:155,comments:42,boosts:55,funding:3100,isTrending:!1,isSponsored:!0,companyInitial:"C",companyColor:"bg-indigo-600",imageUrl:"uploaded:mock-image-fail-123.jpg"},{id:2,company:"Adobe Creative ...",timeAgo:"1d ago",title:"Photoshop 2025: Advanced Editing",description:"A deep dive into the new Generative Fill features and advanced mask editing workflows in the latest Photoshop release. Focus on efficiency gains and creative possibilities for professional graphic designers and digital artists.",likes:120,comments:67,boosts:67,funding:1200,isTrending:!0,isSponsored:!1,companyInitial:"A",companyColor:"bg-red-800",imageUrl:"uploaded:1000002749.jpg-948349c1-85e2-4ea6-a50c-08549e9480a6"},{id:1,company:"Tesla Motors",timeAgo:"6h ago",title:"Tesla Model Y: Full Review and Road Trip",description:"Need a comprehensive review of the Tesla Model Y including a long-distance road trip to showcase charging infrastructure and real-world range performance. The review should cover software updates, comparison with competitors, and include high-quality video footage and imagery suitable for marketing materials.",likes:89,comments:34,boosts:45,funding:2500,isTrending:!0,isSponsored:!0,companyInitial:"T",companyColor:"bg-red-600",imageUrl:"uploaded:1000002747.jpg-6e26ff74-e416-4377-b6f7-72897269edb2"}],te=({comment:e,onReply:s,onToggleLike:a,onToggleDislike:o,onEdit:n,onDelete:i,selectedLanguage:l="English"})=>{const c=e.userId===Q?Z:"https://placehold.co/40x40/CCCCCC/666666?text=G",u=e.text.split(" "),m=u[0],g=m.startsWith("@"),h=g?m.substring(1):null,x=g?u.slice(1).join(" "):e.text,p=!!e.likedByUser,f=!!e.dislikedByUser,[y,b]=d.useState(!1),[v,w]=d.useState(e.text||"");d.useEffect(()=>{w(e.text||"")},[e.text]),d.useRef(null);return t.jsxs("div",{className:"flex space-x-3 py-3 border-b border-gray-50 last:border-b-0 "+(g?"ml-6":""),children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("img",{src:c,alt:e.userName,className:"w-8 h-8 rounded-full object-cover"})}),t.jsxs("div",{className:"flex-grow min-w-0",children:[t.jsxs("div",{className:"bg-gray-100 rounded-xl p-3 inline-block max-w-full",children:[t.jsx("p",{className:"text-sm font-semibold text-gray-800 break-words",children:e.userName}),t.jsxs("p",{className:"text-sm text-gray-700 break-words",children:[g&&t.jsxs("span",{className:"text-indigo-600 font-medium mr-1",children:["@",h]}),x]})]}),t.jsxs("div",{className:"flex items-center space-x-3 mt-1 ml-1 text-xs text-gray-500",children:[t.jsx("span",{className:"font-medium",children:"Just now"}),t.jsxs("button",{onClick:()=>{const t="function"==typeof e.onToggleLike?e.onToggleLike:"function"==typeof a?a:null;t?t(e.id):"function"==typeof s&&s(e)},"aria-pressed":p,className:"flex items-center space-x-1 transition-colors "+(p?"text-red-500":"hover:text-gray-700"),"aria-label":"Like comment",children:[t.jsx(E,{className:"w-3.5 h-3.5",style:{fill:p?"var(--color-like)":"none",stroke:p?"var(--color-like)":"currentColor"}}),t.jsx("span",{className:"text-xs font-medium",children:e.likesCount||0})]}),t.jsxs("button",{onClick:()=>{const t="function"==typeof e.onToggleDislike?e.onToggleDislike:"function"==typeof o?o:null;t?t(e.id):"function"==typeof s&&s(e)},"aria-pressed":f,className:"flex items-center space-x-1 transition-colors "+(f?"text-red-500":"hover:text-gray-700"),"aria-label":"Dislike comment",children:[t.jsx(z,{className:"w-3.5 h-3.5",style:{stroke:f?"var(--color-like)":"currentColor",fill:"none"}}),t.jsx("span",{className:"text-xs font-medium",children:e.dislikesCount||0})]}),t.jsx("button",{onClick:()=>{s(e)},className:"hover:text-gray-700 transition-colors",children:r("Reply",l)})]})]})]})},se=({isOpen:e,onClose:s,requestId:o,selectedLanguage:n="English"})=>{const i=d.useRef(null),l=d.useRef(null),c=d.useRef(null),u=a(),[g,h]=d.useState(.9*window.innerHeight),x=.4*window.innerHeight,p=.95*window.innerHeight,[y,b]=d.useState([]),[v,w]=d.useState(""),[j,N]=d.useState(null),k=d.useCallback(e=>{N(e),w(`@${e.userName} `),c.current&&c.current.focus()},[]),S=d.useCallback(()=>{N(null),w("")},[]),C=()=>{if(!u.user)return void u.openAuthModal();if(""===v.trim())return;let e=v.trim();const t={id:`local_${Date.now()}`,userId:u.user&&u.user.id?u.user.id:Q,userName:u.user&&u.user.name?u.user.name:K,text:e,timestamp:new Date,parentId:j?j.id:null,likesCount:0,dislikesCount:0,likedByUser:!1,dislikedByUser:!1};(async()=>{const s=m(),r=localStorage.getItem("regaarder_token");try{const t=await fetch(`${s}/requests/${o}/comments`,{method:"POST",headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{}},body:JSON.stringify({text:e,parentId:j?j.id:null})});if(t.ok){const e=await t.json();if(e&&e.comment)return void b(t=>{const s=[...t,e.comment];try{console.debug("CommentsModal: dispatching comment_added",{requestId:o,comment:e.comment}),window.dispatchEvent(new CustomEvent("request:comment_added",{detail:{requestId:o,comment:e.comment}}))}catch(r){console.warn(r)}return s})}}catch(a){console.warn("CommentsModal: POST comment failed",a)}b(e=>{const s=[...e,t];try{console.debug("CommentsModal: dispatching comment_added (local)",{requestId:o,comment:t}),window.dispatchEvent(new CustomEvent("request:comment_added",{detail:{requestId:o,comment:t}}))}catch(a){console.warn(a)}return s})})(),w(""),N(null)},q=(e,t)=>{(async()=>{const s=m(),r=localStorage.getItem("regaarder_token");try{const a=await fetch(`${s}/requests/${o}/comments/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{}},body:JSON.stringify({text:t})});if(a.ok){const s=await a.json();return void b(r=>{const a=r.map(r=>r.id===e?s.comment||{...r,text:t}:r);try{console.debug("CommentsModal: dispatching comment_updated",{requestId:o,commentId:e,newText:t}),window.dispatchEvent(new CustomEvent("request:comment_updated",{detail:{requestId:o,commentId:e,newText:t}}))}catch(n){console.warn(n)}return a})}}catch(a){console.warn("CommentsModal: PUT comment failed",a)}b(s=>{const r=s.map(s=>s.id===e?{...s,text:t}:s);try{console.debug("CommentsModal: dispatching comment_updated (local)",{requestId:o,commentId:e,newText:t}),window.dispatchEvent(new CustomEvent("request:comment_updated",{detail:{requestId:o,commentId:e,newText:t}}))}catch(a){console.warn(a)}return r})})()},T=e=>{(async()=>{const t=m(),s=localStorage.getItem("regaarder_token");try{if((await fetch(`${t}/requests/${o}/comments/${e}`,{method:"DELETE",headers:{...s?{Authorization:`Bearer ${s}`}:{}}})).ok)return void b(t=>{const s=t.filter(t=>t.id!==e);try{console.debug("CommentsModal: dispatching comment_deleted",{requestId:o,commentId:e}),window.dispatchEvent(new CustomEvent("request:comment_deleted",{detail:{requestId:o,commentId:e}}))}catch(r){console.warn(r)}return s})}catch(r){console.warn("CommentsModal: DELETE comment failed",r)}b(t=>{const s=t.filter(t=>t.id!==e);try{console.debug("CommentsModal: dispatching comment_deleted (local)",{requestId:o,commentId:e}),window.dispatchEvent(new CustomEvent("request:comment_deleted",{detail:{requestId:o,commentId:e}}))}catch(r){console.warn(r)}return s})})()},I=async(e,t)=>{try{const s=localStorage.getItem("regaarder_token");if(!s)return;const r=m();await fetch(`${r}/comments/react`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({commentId:e,action:t,requestId:o})})}catch(s){console.warn("Failed to react to comment",s)}},E=e=>{u.user?b(t=>t.map(t=>{if(t.id!==e)return t;const s=!!t.likedByUser,r=!!t.dislikedByUser;let a=Number(t.likesCount||0),o=Number(t.dislikesCount||0);return s?(a=Math.max(0,a-1),I(e,"unlike"),{...t,likedByUser:!1,likesCount:a}):(a+=1,I(e,"like"),r?(o=Math.max(0,o-1),{...t,likedByUser:!0,dislikedByUser:!1,likesCount:a,dislikesCount:o}):{...t,likedByUser:!0,likesCount:a})})):u.openAuthModal()},L=e=>{u.user?b(t=>t.map(t=>{if(t.id!==e)return t;const s=!!t.likedByUser,r=!!t.dislikedByUser;let a=Number(t.likesCount||0),o=Number(t.dislikesCount||0);return r?(o=Math.max(0,o-1),I(e,"undislike"),{...t,dislikedByUser:!1,dislikesCount:o}):(o+=1,I(e,"dislike"),s?(a=Math.max(0,a-1),{...t,dislikedByUser:!0,likedByUser:!1,likesCount:a,dislikesCount:o}):{...t,dislikedByUser:!0,dislikesCount:o})})):u.openAuthModal()};d.useEffect(()=>{l.current&&setTimeout(()=>{l.current.scrollTop=l.current.scrollHeight},0)},[y]);const $=d.useCallback(e=>{if(e.preventDefault(),!i.current)return;const t=e.touches[0].clientY,r=i.current.clientHeight,a=e=>{const s=e.touches[0].clientY-t;let a=r-s;a=Math.min(Math.max(a,x),p),h(a)},o=()=>{window.removeEventListener("touchmove",a),window.removeEventListener("touchend",o),i.current&&i.current.clientHeight<x+50&&s()};window.addEventListener("touchmove",a,{passive:!1}),window.addEventListener("touchend",o)},[x,p,s]),R=e=>`comments_request_${e}`;d.useEffect(()=>(e?(h(.9*window.innerHeight),document.body.style.overflow="hidden",(async()=>{try{if(o){const e=m(),t=await fetch(`${e}/requests/${o}/comments`);if(t.ok){const e=await t.json();if(e&&Array.isArray(e.comments))return void b(e.comments)}const s=localStorage.getItem(R(o));if(s){const e=JSON.parse(s);b(Array.isArray(e)?e:[])}else b([])}else b([])}catch(e){try{const e=localStorage.getItem(R(o));if(e){const t=JSON.parse(e);b(Array.isArray(t)?t:[])}else b([])}catch(t){b([])}}})(),N(null),w(""),setTimeout(()=>{c.current&&c.current.focus()},300)):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e,o]),d.useEffect(()=>{try{o&&localStorage.setItem(R(o),JSON.stringify(y))}catch(e){}},[y,o]);const D=v.trim().length>0,_=D?{backgroundColor:"#4b5563",color:"white"}:{backgroundColor:"#e5e7eb",color:"#9ca3af"},B=y.filter(e=>!e.hidden&&!e.deleted),M=B.length;return t.jsxs("div",{className:"fixed inset-0 z-[9999] transition-all duration-300 "+(e?"translate-y-0":"translate-y-full pointer-events-none"),style:{transitionProperty:"transform",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:e?"300ms":"0ms"},children:[t.jsx("div",{className:"absolute inset-0 bg-black transition-opacity duration-300 "+(e?"opacity-50":"opacity-0"),onClick:s}),t.jsxs("div",{ref:i,className:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl flex flex-col shadow-2xl transition-transform duration-300 ease-in-out",style:{height:e?g:0},children:[t.jsx("div",{className:"flex justify-center py-2 flex-shrink-0",onTouchStart:$,children:t.jsx("div",{className:"w-10 h-1.5 bg-gray-300 rounded-full cursor-grab"})}),t.jsx("header",{className:"flex items-center px-4 py-3 border-b border-gray-100 flex-shrink-0",children:t.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[t.jsx(A,{className:"w-5 h-5 mr-2 text-gray-500"})," ",r("Comments",n)]})}),t.jsx("main",{ref:l,className:"flex-grow overflow-y-auto px-4",children:0===M?t.jsx("div",{className:"flex items-center justify-center h-full min-h-[200px]",children:t.jsxs("div",{className:"text-center p-8",children:[t.jsx(A,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),t.jsx("p",{className:"text-gray-700 font-semibold mb-2",children:r("No comments yet",n)}),t.jsx("p",{className:"text-sm text-gray-500",children:r("Be the first to share your thoughts!",n)})]})}):t.jsx("div",{className:"space-y-1 pt-2 pb-4",children:B.map(e=>t.jsx(te,{comment:e,onReply:k,onToggleLike:E,onToggleDislike:L,onEdit:q,onDelete:T,selectedLanguage:n},e.id))})}),t.jsxs("footer",{className:"p-4 border-t border-gray-100 flex-shrink-0",style:{paddingBottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:[j&&t.jsxs("div",{className:"flex items-center justify-between p-2 mb-2 bg-gray-100 rounded-lg text-sm text-gray-700",children:[t.jsxs("span",{className:"font-medium",children:[r("Replying to",n)," ",t.jsx("span",{className:"text-indigo-600 font-semibold",children:j.userName})]}),t.jsx("button",{onClick:S,className:"p-1 rounded-full hover:bg-gray-200 transition-colors","aria-label":"Cancel reply",children:t.jsx(f,{className:"w-4 h-4 text-gray-500"})})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{ref:c,type:"text",placeholder:r("Add a comment... (use @ to mention)",n),value:v,onChange:e=>w(e.target.value),onKeyPress:e=>{"Enter"===e.key&&D&&C()},className:"w-full py-3 px-4 bg-gray-100 border border-gray-200 rounded-xl focus:outline-none focus:ring-1 focus:ring-gray-300 focus:border-gray-300 text-gray-700 placeholder-gray-500"}),t.jsx("button",{onClick:C,disabled:!D,style:_,className:"p-2 rounded-full transition-colors flex-shrink-0 "+(D?"hover:bg-gray-700":"cursor-not-allowed"),children:t.jsx(F,{className:"w-5 h-5"})})]})]})]})]})},re=({isOpen:e,onClose:s,requestId:o,selectedLanguage:n="English"})=>{const i=d.useRef(null),l=d.useRef(null),c=d.useRef(null),[u,g]=d.useState(.9*window.innerHeight),h=.4*window.innerHeight,x=.95*window.innerHeight,p=a(),[f,y]=d.useState(""),[b,v]=d.useState([]),[w,j]=d.useState(!1),N="var(--color-gold)",k="var(--color-gold-light)";d.useEffect(()=>{try{localStorage.getItem("has_seen_suggestions_modal")||(j(!0),localStorage.setItem("has_seen_suggestions_modal","1"))}catch(e){}},[]);const C=async()=>{if(!p.user)return;const e=f.trim();if(!e)return;const t={id:Date.now(),text:e,userName:p.user&&(p.user.name||p.user.email)||K,timestamp:new Date};v(e=>[...e,t]),y("");try{const t=localStorage.getItem("regaarder_token");t&&await fetch(`${m()}/suggestion`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({requestId:o,text:e})})}catch{}c.current&&setTimeout(()=>c.current.focus(),50)};d.useEffect(()=>{l.current&&setTimeout(()=>{l.current.scrollTop=l.current.scrollHeight},0)},[b]);const q=d.useCallback(e=>{if(e.preventDefault(),!i.current)return;const t=e.touches[0].clientY,r=i.current.clientHeight,a=e=>{const s=e.touches[0].clientY-t;let a=r-s;a=Math.min(Math.max(a,h),x),g(a)},o=()=>{window.removeEventListener("touchmove",a),window.removeEventListener("touchend",o),i.current&&i.current.clientHeight<h+50&&s()};window.addEventListener("touchmove",a,{passive:!1}),window.addEventListener("touchend",o)},[h,x,s]);d.useEffect(()=>(e?(g(.9*window.innerHeight),document.body.style.overflow="hidden",y(""),(async()=>{try{if(o){const e=m(),t=await fetch(`${e}/requests/${o}/suggestions`);if(t.ok){const e=await t.json();if(e&&Array.isArray(e.suggestions))return void v(e.suggestions)}}}catch(e){}v([])})(),setTimeout(()=>{c.current&&c.current.focus()},300)):document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e,o]);const T=f.trim().length>0,I=b.length;return t.jsxs("div",{className:"fixed inset-0 z-[9999] transition-all duration-300 "+(e?"translate-y-0":"translate-y-full pointer-events-none"),style:{transitionProperty:"transform",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:e?"300ms":"0ms"},children:[t.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm transition-opacity duration-300 "+(e?"opacity-100":"opacity-0"),onClick:s}),t.jsxs("div",{ref:i,className:"absolute bottom-0 left-0 right-0 rounded-t-3xl flex flex-col shadow-2xl transition-transform duration-300 ease-in-out",style:{height:e?u:0,background:"linear-gradient(180deg, #ffffff 0%, #fefdfb 100%)",boxShadow:"0 -8px 32px rgba(0,0,0,0.12), 0 -2px 8px rgba(203,138,0,0.08)",border:"1px solid rgba(203,138,0,0.1)",borderBottom:"none"},children:[t.jsx("div",{className:"flex justify-center py-2 flex-shrink-0",onTouchStart:q,children:t.jsx("div",{className:"w-10 h-1.5 bg-gray-300 rounded-full cursor-grab"})}),t.jsx("header",{className:"px-5 pt-2 pb-4 flex-shrink-0",children:t.jsx("div",{className:"flex items-start mb-3",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center",style:{background:`linear-gradient(135deg, ${k} 0%, rgba(255,255,255,0.3) 100%)`,boxShadow:"0 2px 8px rgba(203,138,0,0.15)"},children:t.jsx(M,{className:"w-6 h-6",style:{color:N}})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:r("Creative Suggestions",n)}),t.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:r("on Request #req_1767338342444",n).replace("#req_1767338342444",`#${o}`)})]})]})})}),t.jsxs("main",{ref:l,className:"flex-grow overflow-y-auto px-5",children:[w&&t.jsxs("div",{className:"relative p-4 mb-5 rounded-2xl overflow-hidden",style:{background:`linear-gradient(135deg, ${k} 0%, rgba(255,250,240,0.4) 100%)`,border:`1.5px solid ${N}`,boxShadow:"0 4px 12px rgba(203,138,0,0.12)"},children:[t.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 opacity-10",style:{background:`radial-gradient(circle, ${N} 0%, transparent 70%)`}}),t.jsxs("div",{className:"relative flex items-start",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 mr-3",style:{background:`linear-gradient(135deg, ${k} 0%, rgba(255,255,255,0.3) 100%)`,boxShadow:"0 2px 6px rgba(0,0,0,0.08)"},children:t.jsx(S,{className:"w-5 h-5",style:{color:N}})}),t.jsxs("div",{children:[t.jsxs("p",{className:"font-bold text-sm mb-1 flex items-center",style:{color:N},children:[t.jsx(S,{className:"w-4 h-4 mr-1.5",style:{color:N}}),r("Reward Great Ideas",n)]}),t.jsx("p",{className:"text-xs text-gray-700 leading-relaxed",children:r("Creators love your input! Show appreciation by tipping contributors for their valuable creative suggestions that help shape amazing content.",n)})]})]})]}),0===I?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center min-h-[200px]",children:[t.jsx("div",{className:"w-20 h-20 rounded-2xl flex items-center justify-center mb-4",style:{background:`linear-gradient(135deg, ${k} 0%, rgba(255,255,255,0.3) 100%)`,boxShadow:"0 4px 12px rgba(203,138,0,0.1)"},children:t.jsx(M,{className:"w-10 h-10",style:{color:N,opacity:.7}})}),t.jsx("p",{className:"text-lg font-bold text-gray-800 mb-2",children:r("No suggestions yet",n)}),t.jsx("p",{className:"text-sm text-gray-500 max-w-xs",children:r("Be the first to share a creative idea and help shape this content!",n)})]}):t.jsx("div",{className:"space-y-3 pb-4",children:b.map((e,s)=>t.jsxs("div",{className:"p-4 rounded-xl border transition-all hover:shadow-md",style:{background:"linear-gradient(135deg, #ffffff 0%, #fafafa 100%)",borderColor:"#e5e7eb",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold text-white",style:{background:`linear-gradient(135deg, ${N}, ${k})`},children:e.userName.charAt(0)}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs font-semibold text-gray-800",children:e.userName}),t.jsx("p",{className:"text-[10px] text-gray-400",children:r("Just now",n)})]})]}),t.jsx("p",{className:"text-sm text-gray-700 leading-relaxed pl-9",children:e.text})]},s))})]}),t.jsx("footer",{className:"p-5 border-t flex-shrink-0",style:{borderColor:"rgba(203,138,0,0.1)",background:"linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(254,253,251,0.98) 100%)",backdropFilter:"blur(8px)",paddingBottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("input",{ref:c,type:"text",placeholder:r("What would make this video amazing?",n),value:f,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"===e.key&&T&&C()},className:"flex-1 py-3 px-5 bg-white border-2 rounded-2xl focus:outline-none text-gray-800 placeholder-gray-400 transition-all",style:{borderColor:T?N:"#e5e7eb",boxShadow:T?`0 0 0 3px ${k}`:"none"}}),t.jsx("button",{onClick:C,disabled:!T,className:"w-12 h-12 rounded-2xl flex items-center justify-center flex-shrink-0 transition-all shadow-md "+(T?"hover:scale-105 active:scale-95":"cursor-not-allowed opacity-50"),style:{background:T?`linear-gradient(135deg, ${N}, ${k})`:"#e5e7eb",boxShadow:T?"0 4px 12px rgba(203,138,0,0.3)":"none"},children:t.jsx(F,{className:"w-5 h-5 text-white"})})]})})]})]})},ae=({isOpen:e,onClose:s,onConfirm:a,selectedLanguage:o="English"})=>{if(!e)return null;return t.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 px-6",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:s}),t.jsx("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm relative z-10 overflow-hidden animate-in fade-in zoom-in duration-200",children:t.jsxs("div",{className:"p-6 text-center",children:[t.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:r("Ready to Commit?",o)}),t.jsx("p",{className:"text-sm text-gray-600 mb-8 leading-relaxed",children:r("Claiming this request means you take responsibility for creating the video and must submit a first update within 48 hours.",o)}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:s,className:"flex-1 py-3 px-4 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors",children:r("Not Yet",o)}),t.jsx("button",{onClick:a,className:"flex-1 py-3 px-4 text-white font-bold rounded-xl transition-colors shadow-lg",style:{backgroundColor:"var(--color-gold)",boxShadow:"0 4px 12px -2px rgba(var(--color-gold-rgb), 0.35)"},children:r("Claim",o)})]})]})})]})},oe=({message:e,isVisible:s,onClose:a,actionLabel:o,onAction:n,variant:i="success",selectedLanguage:l="English"})=>{const[c,u]=d.useState(0),[m,g]=d.useState(!1),h=d.useRef(0),x=d.useRef(null);d.useEffect(()=>{if(s){const e=setTimeout(()=>{p()},4e3);return()=>clearTimeout(e)}},[s,a]);const p=()=>{g(!0),setTimeout(()=>{a()},300)},f=()=>{Math.abs(c)>80?p():u(0),h.current=0,x.current&&(x.current.style.cursor="grab")},y="success"===i?"bg-green-500":"bg-gray-400";return t.jsx("div",{className:"fixed left-4 right-4 z-[70] flex justify-center transition-all duration-500 ease-out "+(s&&!m?"translate-y-0 opacity-100":"-translate-y-8 opacity-0 pointer-events-none"),style:{top:"calc(12px + env(safe-area-inset-top, 0px))"},children:t.jsxs("div",{ref:x,className:"bg-white text-gray-900 px-4 py-3 rounded-lg shadow-lg flex items-start max-w-md border border-gray-100 w-full cursor-grab select-none transition-all duration-300",style:{transform:`translateX(${c}px)`,animation:s&&!m?"toastSlideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1)":"none"},onTouchStart:e=>{h.current=e.touches[0].clientX},onTouchMove:e=>{const t=e.touches[0].clientX-h.current;u(t)},onTouchEnd:()=>{Math.abs(c)>80?p():u(0)},onMouseDown:e=>{h.current=e.clientX,x.current&&(x.current.style.cursor="grabbing")},onMouseMove:e=>{if(0===h.current)return;const t=e.clientX-h.current;u(t)},onMouseUp:f,onMouseLeave:f,children:[t.jsx("style",{children:"\n                    @keyframes toastSlideDown {\n                        from {\n                            opacity: 0;\n                            transform: translateY(-20px) scale(0.95);\n                        }\n                        to {\n                            opacity: 1;\n                            transform: translateY(0) scale(1);\n                        }\n                    }\n                "}),t.jsx("div",{className:`${y} rounded-full p-1 flex-shrink-0 mt-0.5 mr-3`,children:"success"===i?t.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}):t.jsx("svg",{className:"w-3 h-3 text-white",viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("circle",{cx:"12",cy:"12",r:"6"})})}),t.jsxs("div",{className:"flex-grow mr-2",children:[t.jsx("h4",{className:"text-sm font-bold text-gray-900",children:r("success"===i?"Success":"Notice",l)}),t.jsx("p",{className:"text-sm text-gray-600 leading-snug mt-0.5",children:e})]}),o&&n&&t.jsx("button",{onClick:()=>{n(),a()},className:"mr-3 text-sm font-semibold text-gray-700 hover:underline","aria-label":o,children:o})]})})},ne=({request:e,detailedRank:s,searchQuery:o,isPinned:n=!1,onTogglePin:i,pulseActive:l=!1,onOpenProfile:c,selectedLanguage:h="English",initialBookmarked:y=!1,adminSelections:v={},onBookmarkChange:w=null,isFocused:j=!1})=>{const N="var(--color-gold)",S=X,[C,q]=d.useState(!1),T=e.requesterName||e.creator&&e.creator.name||e.company||"Anonymous",F=e.creator&&e.creator.id||e.createdBy||e.creatorId||null,P=G(e.requesterAvatar||e.creator&&(e.creator.image||e.creator.avatar||e.creator.photoURL)||e.imageUrl||e.avatarUrl||""),[Y,V]=d.useState(!1),[W,Q]=d.useState(!1),[K,Z]=d.useState(!1);d.useEffect(()=>{try{V(!!y)}catch{}},[y]);const[ee,te]=d.useState(0),[ne,ie]=d.useState(!1),le=d.useRef(0),ce=d.useRef(0),de=d.useRef(null),[ue,me]=d.useState(!1),[ge,he]=d.useState(!0),[xe,pe]=d.useState(null),[fe,ye]=d.useState({visible:!1,message:""}),[be,ve]=d.useState(!1),[we,je]=d.useState(!1),[Ne,ke]=d.useState(!1),[Se,Ce]=d.useState(!1),[qe,Te]=d.useState({left:0,top:0}),[Ie,Ee]=d.useState(!1),Ae=d.useRef(null),Le=d.useRef(null),[$e,Re]=d.useState({}),De=d.useRef(null),_e=d.useRef(!1),[Be,Me]=d.useState(!1),[Oe,Fe]=d.useState(!1),[ze,Ue]=d.useState(!1),Pe=d.useRef(null),[Ye,Je]=d.useState(!1),He=d.useRef(null),[Ve,We]=d.useState("spam"),[Xe,Ge]=d.useState(""),[Qe,Ke]=d.useState({visible:!1,message:""}),[Ze,et]=d.useState(!1),[tt,st]=d.useState(!1),[rt,at]=d.useState(!1),[ot,nt]=d.useState(e.likes),[it,lt]=d.useState(!1),[ct,dt]=d.useState(!1),ut=a(),[mt,gt]=d.useState(!!e.claimed),[ht,xt]=d.useState(e.claimedBy||null),[pt,ft]=d.useState(!1),[yt,bt]=d.useState(!1),[vt,wt]=d.useState({visible:!1,message:""}),[jt,Nt]=d.useState(!1),[kt,St]=d.useState(!1),[Ct,qt]=d.useState(e.title||""),[Tt,It]=d.useState(e.description||""),[Et,At]=d.useState(e.meta?.selectedVideoLength||""),[Lt,$t]=d.useState(e.meta?.selectedPrivacy||"public"),[Rt,Dt]=d.useState(e.meta?.selectedFormat||"one-time"),[_t,Bt]=d.useState(!1),[Mt,Ot]=d.useState(!1);d.useEffect(()=>{gt(!!e.claimed),xt(e.claimedBy||null);try{qt(e.title||"")}catch(t){}try{It(e.description||"")}catch(t){}try{At(e.meta?.selectedVideoLength||"")}catch(t){}try{$t(e.meta?.selectedPrivacy||"public")}catch(t){}try{Dt(e.meta?.selectedFormat||"one-time")}catch(t){}},[e.claimed,e.claimedBy,e.title,e.description,e.meta]);const[Ft,zt]=d.useState(!1),[Ut,Pt]=d.useState(s.totalInfluence);d.useEffect(()=>{Pt(s.totalInfluence)},[s.totalInfluence]),d.useEffect(()=>{try{const t=localStorage.getItem("request_reacts_v1");if(t){const s=(JSON.parse(t)||{})[e.id];s&&("number"==typeof s.likesCount&&nt(s.likesCount),"boolean"==typeof s.isLiked&&ve(s.isLiked),"boolean"==typeof s.isDisliked&&Me(s.isDisliked))}}catch(t){}},[e.id]),d.useEffect(()=>{P?e.imageUrl&&e.imageUrl.includes("mock-image-fail")?zt(!0):zt(!1):zt(!0)},[e.imageUrl,P]);const Yt=d.useRef(0),Jt=e&&"string"==typeof e.description?e.description:"",Ht=Jt.length>120,Vt=C||!Ht?Jt:Jt.substring(0,120)+"...",Wt=d.useRef(null),Xt=d.useRef(!1),Gt=async()=>{const t=`${g}/share/request/${encodeURIComponent(e.id)}`,s=e.title||"Check out this request on Regaarder",a=`${s}\n\nRequested by ${T}\n\n${t}`;try{if(navigator&&navigator.share)await navigator.share({title:s,text:a,url:t});else try{await navigator.clipboard.writeText(a),ye({visible:!0,message:r("Link copied to clipboard",h)})}catch{}}catch(o){if("AbortError"!==o.name)try{await navigator.clipboard.writeText(a),ye({visible:!0,message:r("Link copied to clipboard",h)})}catch{}}},Qt=()=>{Xt.current=!1,Wt.current&&clearTimeout(Wt.current),Wt.current=setTimeout(()=>{Xt.current=!0;try{navigator.vibrate&&navigator.vibrate(30)}catch{}Gt()},600)},Kt=()=>{Wt.current&&(clearTimeout(Wt.current),Wt.current=null)},Zt=(e,t)=>{le.current=e,ce.current=t,ie(!1),te(0)},es=(e,t,s)=>{const r=e-le.current,a=t-ce.current;if(ne){try{s&&s.preventDefault&&s.preventDefault()}catch(o){}te(r)}else{const e=Math.abs(r),t=Math.abs(a);if(!(e>12&&e>t*1.3))return;ie(!0);try{s&&s.preventDefault&&s.preventDefault()}catch(o){}te(r)}},ts=()=>{ne?(ie(!1),ee<-110?(pe({type:"dismiss",prevVisible:ge}),me(!0),de.current=setTimeout(()=>{he(!1),me(!1)},420),te(0),ye({visible:!0,message:"Hidden from feed"})):te(0)):te(0)},ss=e=>{Kt(),es(e.clientX,e.clientY,e)},rs=e=>{Kt(),window.removeEventListener("mousemove",ss),window.removeEventListener("mouseup",rs),Xt.current?Xt.current=!1:ts()},as=()=>{if(!ut.user)return void ut.openAuthModal();const t="request_reacts_v1";ve(s=>{const r=!s;if(nt(s=>{const a=r?s+1:Math.max(0,s-1);r&&Be&&Me(!1);try{const s=localStorage.getItem(t),o=s?JSON.parse(s):{};o[e.id]=o[e.id]||{},o[e.id].likesCount=a,o[e.id].isLiked=r,o[e.id].isDisliked=(!r||!Be)&&(o[e.id].isDisliked||!1),localStorage.setItem(t,JSON.stringify(o))}catch(o){}return a}),Pt(e=>r?e+1:Math.max(0,e-1)),r)try{if(!localStorage.getItem("heart_longpress_hint_shown"))try{const e=Ae.current,t=8;if(e&&e.getBoundingClientRect){const s=e.getBoundingClientRect(),r=s.left+s.width/2,a=s.top-t;Te({left:r,top:a}),Ce(!0),setTimeout(()=>{try{const e=document.querySelector(".hint-bubble");if(e&&e.offsetWidth){const t=e.offsetWidth,s=t/2,o=s+62,n=window.innerWidth-s-8;let i=r;i<o&&(i=o),i>n&&(i=n);const l=Math.max(8,a);let c=r-i+s-18;const d=12,u=Math.max(12,t-12),m=Math.max(d,Math.min(u,c));Te({left:i,top:l,tailLeft:m,tailClass:"hint-tail-left-edge"})}}catch(e){}},20),function(){let e=null;const t=()=>{try{e&&clearTimeout(e)}catch(r){}try{document.removeEventListener("pointerdown",t,!0)}catch(r){}try{document.removeEventListener("touchstart",t,!0)}catch(r){}try{window.removeEventListener("keydown",s,!0)}catch(r){}try{localStorage.setItem("heart_longpress_hint_shown","1")}catch(r){}Ce(!1)},s=e=>{"Escape"===e.key&&t()};try{document.addEventListener("pointerdown",t,{once:!0,capture:!0}),document.addEventListener("touchstart",t,{once:!0,capture:!0}),window.addEventListener("keydown",s,{capture:!0})}catch(r){}try{e=setTimeout(t,15e3)}catch(r){}}()}else{const e=Math.max(48,window.innerWidth/2);Te({left:e,top:48}),Ce(!0),setTimeout(()=>Ce(!1),3800)}}catch(a){}}catch(o){}return r});try{const t=ut.user&&ut.user.token||localStorage.getItem("regaarder_token"),s=be?"unlike":"like";fetch(`${m()}/requests/react`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({requestId:e.id,action:s})}).catch(()=>{})}catch(s){}},[os,ns]=d.useState(!1),is=()=>{ns(!1)},ls=async()=>{const t=`${g}/share/request/${encodeURIComponent(e.id)}`,s=`${e.title}\n${t}`,r=await(async e=>{try{if(navigator&&navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(e),!0}catch(t){console.error("navigator.clipboard.writeText failed",t)}try{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",t.style.top="0",document.body.appendChild(t),t.focus(),t.select();const s=document.execCommand("copy");return document.body.removeChild(t),!!s}catch(t){return console.error("fallback copy failed",t),!1}})(s);ye(r?{visible:!0,message:"Link copied to clipboard"}:{visible:!0,message:"Copy failed"}),Ue(!1),Ee(!1)},cs=e=>{_e.current=!1,De.current&&clearTimeout(De.current),e.touches?e.touches[0].clientX:e.clientX,e.touches?e.touches[0].clientY:e.clientY,De.current=setTimeout(()=>{_e.current=!0;try{if(Ae.current){const e=Ae.current.getBoundingClientRect(),t=e.left+e.width/2,s=e.top-8;Re({position:"fixed",left:`${t}px`,top:`${s}px`,transform:"translate(-50%, -100%)"})}}catch(e){}Ee(!0)},520)},ds=()=>{De.current&&(clearTimeout(De.current),De.current=null)};if(d.useEffect(()=>{if(!Ie)return;const e=e=>{const t=e.target;Ae.current&&Ae.current.contains(t)||Le.current&&Le.current.contains(t)||Ee(!1)};return window.addEventListener("pointerdown",e),()=>window.removeEventListener("pointerdown",e)},[Ie]),d.useEffect(()=>{if(Ie)return Pe.current&&clearTimeout(Pe.current),Pe.current=setTimeout(()=>Ee(!1),4e3),()=>{Pe.current&&(clearTimeout(Pe.current),Pe.current=null)};Pe.current&&(clearTimeout(Pe.current),Pe.current=null)},[Ie]),!ge)return null;const us="#9333ea",ms=(e.boosts||0)>=1,gs=v[e.id]||!1,hs=ms||gs,xs=hs?us:"#d1d5db",ps=hs?"2px":"1px",fs=hs?((e,t=1)=>{const s=e.replace("#",""),r=parseInt(3===s.length?s.split("").map(e=>e+e).join(""):s,16);return`rgba(${r>>16&255}, ${r>>8&255}, ${255&r}, ${t})`})(us,.05):"#ffffff",ys={position:"absolute",top:"50%",right:"-12px",transform:"translateY(-50%) rotate(-90deg)",transformOrigin:"50% 50%",backgroundColor:mt?"#d1d5db":S,color:"#6b7280",fontSize:"11px",fontWeight:"bold",padding:"5px 12px",borderRadius:"6px",letterSpacing:"0.5px",boxShadow:mt?"0 2px 6px rgba(107, 114, 128, 0.2)":"none",border:"none",whiteSpace:"nowrap",cursor:mt?"default":"pointer",height:"auto",lineHeight:"1",zIndex:10,transition:"all 0.3s ease"},bs={background:`radial-gradient(circle at 100% 0%, ${S} 0%, rgba(243, 244, 246, 0.8) 70%, transparent 100%)`,zIndex:0,pointerEvents:"none"},vs={backgroundColor:N,color:"white",fontWeight:"bold",padding:"4px 10px",borderRadius:"0 10px 0 10px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"14px",zIndex:5},ws={backgroundColor:S,color:N,fontWeight:"600",padding:"3px 10px",borderRadius:"20px",fontSize:"12px",display:"inline-flex",alignItems:"center",zIndex:5},js=(o||"").trim(),Ns=e=>{if(!js)return e;const s=new RegExp(`(${r=js,r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"ig");var r;return e.split(s).map((e,s)=>s%2==1?t.jsx("mark",{className:"bg-[var(--color-gold-cream)] text-gray-900 rounded px-0.5",children:e},s):e)},ks=be?Ne?"var(--color-like-active)":we?"var(--color-like-hover)":"var(--color-like)":we?"rgba(107, 114, 128, 0.3)":"none",Ss=be?Ne?"var(--color-like-active)":we?"var(--color-like-hover)":"var(--color-like)":"#6B7280",Cs=Y?"#6B7280":"none",qs=Y?"#6B7280":K?"var(--color-gold)":W?"var(--color-gold-light)":"currentColor",Ts=K||W?"0 8px 22px rgba(2,6,23,0.06)":"0 6px 18px rgba(2,6,23,0.07)",Is=ee/20,Es=ee<0?Math.min(8,-ee/18):Math.min(2,ee/80),As=Math.min(200,Math.abs(ee)),Ls=ue?.95:1-Math.min(.04,As/200),$s=ue?"perspective(800px) translateX(-140%) rotate(-20deg) skewY(-18deg) rotateX(12deg) scale(0.86)":`translateX(${ee}px) rotate(${Is}deg) skewY(${Es}deg) scale(${Ls})`,Rs=ne?"none":ue?"transform 420ms cubic-bezier(.2,.8,.2,1), opacity 360ms ease":"transform 300ms cubic-bezier(.22,.9,.35,1)";return t.jsxs(t.Fragment,{children:[t.jsxs("div",{id:`request-card-${e.id}`,className:"relative mb-6 overflow-visible",children:[t.jsx("div",{className:"absolute inset-0 flex items-center justify-end px-4 z-0 pointer-events-none",children:t.jsxs("div",{className:"flex items-center text-gray-500 pr-3",style:{opacity:ee<0?Math.min(1,-ee/160):0},children:[t.jsx(f,{className:"w-6 h-6 mr-2"}),t.jsx("span",{className:"text-sm font-semibold",children:"Hide"})]})}),t.jsxs("div",{className:`p-5 pb-4 pr-12 rounded-3xl relative z-10 ${l?"pinned-pulse":""} ${j?"ring-2 ring-yellow-400 ring-offset-2 ring-offset-gray-50":""}`,style:{backgroundColor:fs,border:`${ps} solid ${xs}`,boxShadow:"0 10px 30px rgba(2,6,23,0.07), 0 -4px 12px rgba(2,6,23,0.03)",transform:$s,opacity:ue?0:1,transition:Rs,touchAction:"pan-y",willChange:"transform, opacity",transformOrigin:"50% 50%"},onTouchStart:e=>{e.touches&&0!==e.touches.length&&(Zt(e.touches[0].clientX,e.touches[0].clientY),Qt())},onTouchMove:e=>{e.touches&&0!==e.touches.length&&(Kt(),es(e.touches[0].clientX,e.touches[0].clientY,e))},onTouchEnd:e=>{Kt(),Xt.current?Xt.current=!1:ts(),(e=>{if(!(it||ct||Ze)&&"touchend"===e.type){const e=(new Date).getTime();e-Yt.current<300?(be||(as(),He.current&&clearTimeout(He.current),Je(!0),He.current=setTimeout(()=>Je(!1),900)),Yt.current=0):Yt.current=e}})(e)},onMouseDown:e=>{Zt(e.clientX,e.clientY),Qt(),window.addEventListener("mousemove",ss),window.addEventListener("mouseup",rs)},onContextMenu:e=>{e.preventDefault(),Gt()},children:[t.jsx("style",{children:"\n                    @keyframes dt-heart-pop {\n                        0% { transform: translate(-50%, -50%) scale(0.6); opacity: 0.0; filter: drop-shadow(0 2px 6px rgba(0,0,0,0.08)); }\n                        30% { transform: translate(-50%, -50%) scale(1.6); opacity: 1; }\n                        60% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.9; }\n                        100% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }\n                    }\n                    @keyframes dt-star {\n                        0% { transform: translate(-50%, -50%) scale(0.2) translateY(0); opacity: 1; }\n                        60% { transform: translate(-50%, -50%) scale(1.05) translateY(-36px); opacity: 1; }\n                        100% { transform: translate(-50%, -50%) scale(1) translateY(-56px); opacity: 0; }\n                    }\n                    .dt-overlay { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); pointer-events: none; z-index: 30; }\n                    .dt-heart { width: 84px; height: 84px; color: var(--color-like); transform-origin: center center; animation: dt-heart-pop 900ms cubic-bezier(.2,.9,.25,1) forwards; }\n                    .dt-burst { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 120px; height: 120px; }\n                    .dt-star { position: absolute; left: 50%; top: 50%; display: block; width: 12px; height: 12px; color: #FFD86B; }\n                    .dt-star:nth-child(1) { transform: translate(-50%, -50%); animation: dt-star 820ms ease-out 0ms forwards; }\n                    .dt-star:nth-child(2) { transform: translate(-50%, -50%); animation: dt-star 820ms ease-out 40ms forwards; transform-origin: 50% 50%; }\n                    .dt-star:nth-child(3) { transform: translate(-50%, -50%); animation: dt-star 820ms ease-out 80ms forwards; }\n                    .dt-star:nth-child(4) { transform: translate(-50%, -50%); animation: dt-star 820ms ease-out 120ms forwards; }\n                    .dt-star:nth-child(5) { transform: translate(-50%, -50%); animation: dt-star 820ms ease-out 160ms forwards; }\n                    .dt-star svg { width: 100%; height: 100%; }\n                "}),Ye&&t.jsx("div",{className:"dt-overlay",children:t.jsxs("div",{style:{position:"relative",width:0,height:0},children:[t.jsxs("div",{className:"dt-burst","aria-hidden":!0,children:[t.jsx("span",{className:"dt-star",style:{transform:"translate(-20px,-10px)"},children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2l1.9 4.1L18 8l-4 2.9L14 15l-2-1.3L10 15l.9-4.1L8 8l4.1-1.9L12 2z"})})}),t.jsx("span",{className:"dt-star",style:{transform:"translate(12px,-6px)"},children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2l1.9 4.1L18 8l-4 2.9L14 15l-2-1.3L10 15l.9-4.1L8 8l4.1-1.9L12 2z"})})}),t.jsx("span",{className:"dt-star",style:{transform:"translate(26px,8px)"},children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2l1.9 4.1L18 8l-4 2.9L14 15l-2-1.3L10 15l.9-4.1L8 8l4.1-1.9L12 2z"})})}),t.jsx("span",{className:"dt-star",style:{transform:"translate(-26px,6px)"},children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2l1.9 4.1L18 8l-4 2.9L14 15l-2-1.3L10 15l.9-4.1L8 8l4.1-1.9L12 2z"})})}),t.jsx("span",{className:"dt-star",style:{transform:"translate(0px,26px)"},children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M12 2l1.9 4.1L18 8l-4 2.9L14 15l-2-1.3L10 15l.9-4.1L8 8l4.1-1.9L12 2z"})})})]}),t.jsx("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)"},children:t.jsx(E,{className:"dt-heart"})})]})}),Se&&"undefined"!=typeof document&&u.createPortal(t.jsx("div",{className:"hint-bubble",style:{position:"fixed",left:qe.left,top:qe.top,transform:"translate(-50%, -120%)",zIndex:9999,pointerEvents:"none"},children:t.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[t.jsxs("div",{className:"hint-inner",role:"status","aria-live":"polite",children:[t.jsx(A,{className:"w-5 h-5",style:{color:"#fff",flexShrink:0}}),t.jsx("div",{className:"hint-text",children:"Long-press the heart to access more options."})]}),t.jsx("div",{className:qe&&qe.tailClass?qe.tailClass:"hint-tail",style:qe&&qe.tailClass&&-1!==qe.tailClass.indexOf("left-edge")?{top:"50%",left:"-12px",transform:"translateY(-50%)"}:{left:qe&&qe.tailLeft?`${qe.tailLeft}px`:"50%"}})]})}),document.body),t.jsx("div",{className:"absolute top-0 right-0 w-40 sm:w-44 md:w-48 h-40 sm:h-44 md:h-48 rounded-tr-xl overflow-hidden pointer-events-none",style:bs,"aria-hidden":"true"}),ut.user&&!(e.creator&&e.creator.id&&ut.user.id&&e.creator.id===ut.user.id)&&t.jsx("button",{onTouchStart:e=>e.stopPropagation(),onTouchEnd:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onClick:()=>{mt||(ut.user?e.creator&&e.creator.id&&ut.user&&ut.user.id&&e.creator.id===ut.user.id?wt({visible:!0,message:"You cannot claim your own request"}):ft(!0):ut.openAuthModal())},style:ys,className:"focus:outline-none hover:text-gray-900 transition duration-150",disabled:mt,title:mt&&ht?`Claimed by ${ht.name}`:"Claim this request","aria-label":mt&&ht?`Claimed by ${ht.name}`:"Claim this request",children:mt?"âœ“ Claimed":"CLAIM"}),t.jsxs("div",{onTouchStart:e=>e.stopPropagation(),onTouchEnd:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"absolute top-4 right-4 flex flex-col items-end space-y-1 z-10",children:[e.isTrending&&t.jsxs("div",{style:ws,children:[t.jsx(b,{className:"w-4 h-4 mr-1",style:{color:N}}),r("Trending",h)]}),ms&&t.jsxs("div",{style:{backgroundColor:us,color:"white",fontWeight:"600",padding:"3px 10px",borderRadius:"20px",fontSize:"12px",display:"inline-flex",alignItems:"center",zIndex:5,marginLeft:"6px"},children:[t.jsx(L,{className:"w-4 h-4 mr-1"}),r("Boosted",h)]}),gs&&!ms&&t.jsxs("div",{style:{backgroundColor:us,color:"white",fontWeight:"600",padding:"3px 10px",borderRadius:"20px",fontSize:"12px",display:"inline-flex",alignItems:"center",zIndex:5,marginLeft:"6px"},children:[t.jsx($,{className:"w-4 h-4 mr-1"}),"Admin Selected"]}),t.jsxs("div",{style:vs,children:["$",Number(e.funding||0).toFixed(2)]})]}),t.jsx("div",{className:"absolute top-4 left-4 z-10",children:t.jsxs("div",{className:"bg-gray-800 text-white text-xs font-bold px-3 py-1 rounded-full",children:["RANK #",s.rank]})}),n&&t.jsx("button",{onClick:()=>{if(n)ns(!0);else try{"function"==typeof i&&i()}catch(e){}},"aria-label":n?"Unpin request":"Pin request",className:"absolute z-20 focus:outline-none",style:{top:"2px",left:"44px",transform:"translateY(-50%)",background:"transparent",padding:4,border:"none"},children:t.jsx(R,{className:"w-5 h-5",style:{fill:"var(--color-gold)",stroke:"#6b7280"}})}),t.jsx("div",{className:"flex items-start mb-4 relative z-10 pt-10",children:t.jsxs("div",{className:"flex items-center",children:[t.jsxs("button",{className:"w-10 h-10 rounded-full overflow-hidden mr-3 flex-shrink-0 relative cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all",style:{focusRingColor:"var(--color-gold)"},onClick:t=>{t.stopPropagation(),c&&T&&"Anonymous"!==T&&"Community"!==T&&c(T,!0,{id:F,avatar:P,bio:e.creator&&e.creator.bio||"Creating engaging content",stats:{videos:e.creator&&e.creator.videosCount||0,requests:e.creator&&e.creator.requestsCompleted||0,followers:e.creator&&(e.creator.followers||e.creator.followerCount)||0,following:e.creator&&e.creator.following||0},verified:e.creator&&e.creator.verified||!1,joinedDate:e.creator&&e.creator.joinedYear||(new Date).getFullYear()})},children:[t.jsx("img",{src:P,alt:`${T} profile`,className:"w-full h-full object-cover absolute inset-0 z-10 transition-opacity duration-300 "+(Ft?"opacity-0":"opacity-100"),onError:()=>{zt(!0)},onLoad:()=>zt(!1)}),(()=>{const s=String(T).charAt(0).toUpperCase(),r=["bg-gray-400","bg-blue-600","bg-indigo-600","bg-green-600","bg-red-600","bg-yellow-500","bg-pink-600"],a=String(e.id||"").split("").reduce((e,t)=>e+t.charCodeAt(0),0),o=e.companyColor||r[a%r.length];return t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white text-xl font-bold ${o}`,style:{opacity:Ft?1:0,transition:"opacity 0.3s",position:"absolute",inset:0},children:s})})()]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:T}),t.jsx("p",{className:"text-xs text-gray-500",children:e.timeAgo})]})]})}),t.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2 leading-tight",children:Ns(e.title)}),t.jsx("p",{className:"text-[15px] leading-relaxed text-gray-600 mb-4",children:Ns(Vt)}),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Ht&&t.jsxs("button",{onTouchStart:e=>e.stopPropagation(),onTouchEnd:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onClick:()=>{q(!C)},className:"flex items-center text-sm font-semibold text-gray-600 hover:text-gray-900 transition-colors",children:[r(C?"See less":"See more...",h),C?t.jsx(_,{className:"w-4 h-4 ml-1"}):t.jsx(k,{className:"w-4 h-4 ml-1"})]}),e.isSponsored&&t.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Sponsored"})]}),t.jsxs("div",{className:"border-t border-gray-100 pt-3 flex justify-between items-center",children:[t.jsxs("div",{className:"flex space-x-4 text-gray-600",children:[t.jsxs("button",{ref:Ae,onTouchStart:e=>{e.stopPropagation(),ke(!0),cs(e)},onTouchEnd:e=>{ds(),ke(!1),e.stopPropagation(),_e.current&&(_e.current=!1)},onMouseDown:e=>{e.stopPropagation(),ke(!0),cs(e)},onMouseUp:e=>{ds(),ke(!1)},onMouseEnter:()=>je(!0),onMouseLeave:()=>{je(!1),ke(!1),ds()},onClick:e=>{_e.current?_e.current=!1:as()},className:`flex items-center space-x-1 p-0 transition-colors transform-gpu hover:scale-105 active:scale-95 ${be?"text-gray-700":"text-gray-500"} focus:outline-none`,children:[t.jsx(E,{className:"w-5 h-5 transition-colors",style:{strokeWidth:2,fill:ks,stroke:Ss,transition:"transform .12s ease, fill .12s ease, stroke .12s ease"}}),t.jsx("span",{className:"text-xs font-medium",children:ot})]}),t.jsxs("button",{onClick:()=>{if(!ut.user)return ut.openAuthModal();lt(!0)},onTouchStart:e=>e.stopPropagation(),onTouchEnd:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"flex items-center space-x-1 p-0 transition-colors text-gray-500 hover:text-gray-700 focus:outline-none",children:[t.jsx(A,{className:"w-5 h-5"}),t.jsx("span",{className:"text-xs font-medium",children:e.comments})]}),t.jsxs("button",{onClick:()=>{ut.user?et(!0):ut.openAuthModal()},onTouchStart:e=>e.stopPropagation(),onTouchEnd:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"flex items-center space-x-1 p-0 transition-colors text-gray-500 hover:text-gray-700 focus:outline-none",children:[t.jsx(x,{className:"w-5 h-5"}),t.jsxs("span",{className:"text-xs font-medium",children:[e.boosts," ",r("Boosts",h)]})]})]}),t.jsxs("div",{className:"flex space-x-2",style:{marginRight:"-28px"},children:[ut.user&&e.createdBy&&String(ut.user.id)===String(e.createdBy)&&!mt&&t.jsx("button",{onClick:e=>{e.stopPropagation(),Nt(!0)},className:"flex items-center justify-center p-2.5 h-9 w-9 rounded-full bg-white hover:bg-gray-100 transition-colors ring-1 ring-gray-200 hover:shadow-md text-gray-600",title:"Edit request","aria-label":"Edit request",children:t.jsx(I,{className:"w-5 h-5"})}),t.jsx("button",{onTouchEnd:e=>{e.stopPropagation(),Z(!1)},onTouchStart:()=>Z(!0),onMouseEnter:()=>Q(!0),onMouseLeave:()=>{Q(!1),Z(!1)},onMouseDown:()=>Z(!0),onMouseUp:()=>Z(!1),onFocus:()=>Q(!0),onBlur:()=>{Q(!1),Z(!1)},onClick:()=>{const t=ut.user&&ut.user.token||localStorage.getItem("regaarder_token"),s=Y,r=!s;V(r),console.log("Toggling bookmark:",{requestId:e.id,action:r?"add":"remove",title:e.title,hasToken:!!t});const a=m();(async()=>{const s={"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}};if(r){const t=await fetch(`${a}/bookmarks/requests`,{method:"POST",headers:s,body:JSON.stringify({requestId:e.id,title:e.title||""})}),r=await t.json();if(console.log("Bookmark add response:",r),!t.ok||!r.success)throw new Error("Bookmark add failed");return!0}{const t=await fetch(`${a}/bookmarks/requests`,{method:"DELETE",headers:s,body:JSON.stringify({requestId:e.id})}),r=await t.json();if(console.log("Bookmark remove response:",r),!t.ok||!r.success)throw new Error("Bookmark remove failed");return!0}})().then(()=>{r&&Ke({visible:!0,message:"Saved to bookmarks"});try{w&&w(e.id,r)}catch{}}).catch(e=>{console.error("Bookmark error:",e),V(s),wt({visible:!0,message:"Bookmark failed"})})},className:"flex items-center justify-center p-2.5 h-9 w-9 rounded-full transition-transform transform-gpu hover:scale-105 active:scale-95 focus:outline-none ring-1 ring-gray-200",style:{boxShadow:Ts},children:t.jsx(B,{className:"w-5 h-5 transition-colors",style:{strokeWidth:2,fill:Cs,stroke:qs,transition:"transform .12s ease, fill .12s ease, stroke .12s ease"}})}),t.jsx("button",{onClick:()=>{ut.user?dt(!0):ut.openAuthModal()},onTouchStart:e=>e.stopPropagation(),onTouchEnd:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),className:"flex items-center justify-center p-2.5 h-10 w-10 rounded-full transition-colors focus:outline-none",style:{backgroundColor:ut?.user?.accentColor?`${ut.user.accentColor}20`:"rgba(147, 51, 234, 0.12)",color:ut?.user?.accentColor||"#9333ea"},children:t.jsx(M,{className:"w-5 h-5"})}),jt&&u.createPortal(t.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Nt(!1)}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 relative z-10 w-full max-w-lg",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:"Edit request"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Update your request details. Changes are visible to everyone."}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1",children:"Title"}),t.jsx("input",{value:Ct,onChange:e=>qt(e.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition-shadow",placeholder:"Request title"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1",children:"Description"}),t.jsx("textarea",{value:Tt,onChange:e=>It(e.target.value),className:"w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition-shadow",rows:4,placeholder:"Describe what you want..."})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Duration"}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>Bt(!_t),className:"w-full text-left bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 text-gray-700 py-3 px-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all font-semibold cursor-pointer text-[15px] hover:border-purple-300 hover:from-purple-50 flex items-center justify-between",children:[t.jsx("span",{children:Et||"Any duration"}),t.jsx(k,{className:"w-4 h-4 text-gray-400 transition-transform "+(_t?"rotate-180":"")})]}),_t&&t.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-2xl shadow-xl z-50",children:[{value:"",label:"Any duration"},{value:"Short (< 2 min)",label:"Short (< 2 min)"},{value:"Medium (2-5 min)",label:"Medium (2-5 min)"},{value:"Long (5+ min)",label:"Long (5+ min)"}].map(e=>t.jsx("button",{onClick:()=>{At(e.value),Bt(!1)},className:"w-full text-left px-4 py-3 font-medium transition-colors "+(Et===e.value?"bg-purple-100 text-purple-700":"text-gray-700 hover:bg-gray-50"),children:e.label},e.value))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Format"}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>Ot(!Mt),className:"w-full text-left bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 text-gray-700 py-3 px-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all font-semibold cursor-pointer text-[15px] hover:border-purple-300 hover:from-purple-50 flex items-center justify-between",children:[t.jsx("span",{children:"one-time"===Rt?"One-Time":"series"===Rt?"Series":"recurrent"===Rt?"Recurrent":"catalogue"===Rt?"Catalogue":"One-Time"}),t.jsx(k,{className:"w-4 h-4 text-gray-400 transition-transform "+(Mt?"rotate-180":"")})]}),Mt&&t.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border-2 border-gray-200 rounded-2xl shadow-xl z-50",children:[{value:"one-time",label:"One-Time"},{value:"recurrent",label:"Recurrent"},{value:"series",label:"Series"},{value:"catalogue",label:"Catalogue"}].map(e=>t.jsx("button",{onClick:()=>{Dt(e.value),Ot(!1)},className:"w-full text-left px-4 py-3 font-medium transition-colors "+(Rt===e.value?"bg-purple-100 text-purple-700":"text-gray-700 hover:bg-gray-50"),children:e.label},e.value))})]})]})]})]}),t.jsxs("div",{className:"flex justify-between items-center mt-8 pt-5 border-t border-gray-100",children:[t.jsx("button",{onClick:async()=>{St(!0)},className:"inline-flex items-center justify-center w-10 h-10 rounded-lg text-red-600 hover:bg-red-50 transition-colors",title:"Delete Request",children:t.jsx(O,{size:18})}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>Nt(!1),className:"px-6 py-2.5 rounded-full bg-gray-100 font-semibold text-gray-600 hover:bg-gray-200 transition-colors text-[15px]",children:"Cancel"}),t.jsx("button",{onClick:async()=>{const t=localStorage.getItem("regaarder_token"),s=m();try{const a={...e.meta||{},selectedVideoLength:Et,selectedFormat:Rt,selectedPrivacy:Lt},o=await fetch(`${s}/requests/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({title:Ct,description:Tt,meta:a})});if(!o.ok){const e=await o.json().catch(()=>({error:"Update failed"}));throw new Error(e.error||"Update failed")}const n=await o.json();try{window.dispatchEvent(new CustomEvent("request:updated",{detail:{request:n.request}}))}catch(r){}Nt(!1),wt({visible:!0,message:"Request updated"})}catch(a){console.error("Update failed",a),wt({visible:!0,message:a.message||"Update failed"})}},className:"px-7 py-2.5 rounded-full font-semibold shadow-lg shadow-purple-200 hover:shadow-purple-300 transition-all text-[15px] transform active:scale-95",style:{backgroundColor:"var(--color-gold)",color:"#fff"},children:"Save"})]})]})]})]}),document.body)]})]})]})]}),t.jsx(se,{isOpen:it,onClose:()=>{lt(!1)},requestId:e.id,selectedLanguage:h}),t.jsx(re,{isOpen:ct,onClose:()=>{dt(!1)},requestId:e.id,selectedLanguage:h}),t.jsx(p,{isOpen:Ze,onClose:()=>{et(!1)},requestId:e.id,detailedRank:{...s,totalInfluence:Ut},onGiveLikeFree:()=>{as(),wt({visible:!0,message:"You gave a like â€” thanks!"})},selectedLanguage:h}),t.jsx(ae,{isOpen:pt,onClose:()=>ft(!1),onConfirm:async()=>{const t=ut.user&&ut.user.token||localStorage.getItem("regaarder_token");if(t)try{const r=await fetch(`${m()}/claim`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({requestId:e.id})});if(!r.ok){const e=await r.json().catch(()=>({error:"Claim failed"}));if(e.requestValueLimitExceeded)return ft(!1),void at(!0);if(429===r.status&&e.dailyClaimLimitReached)return ft(!1),void st(!0);throw new Error(e.error||"Claim failed")}const a=await r.json();gt(!0),xt(a.claimedBy),ft(!1),bt(!0);const o={requestId:e.id,id:e.id,title:e.title||"Untitled Request",requesterName:e.company||e.creator&&e.creator.name||"Anonymous",requesterAvatar:G(e.creator&&(e.creator.image||e.creator.avatar)?e.creator.image||e.creator.avatar:null)||null,funding:e.funding||0,description:e.description||"",currentStep:1,claimedBy:a.claimedBy,claimedAt:a.claimedAt||(new Date).toISOString()},n=localStorage.getItem("claimedRequests");let i=[];try{i=n?JSON.parse(n):[],Array.isArray(i)||(i=[])}catch(s){i=[]}if(i.some(e=>e.id===o.id)){const e=i.findIndex(e=>e.id===o.id);-1!==e&&(i[e]=o),localStorage.setItem("claimedRequests",JSON.stringify(i))}else i.push(o),localStorage.setItem("claimedRequests",JSON.stringify(i));window.dispatchEvent(new CustomEvent("request:claimed",{detail:o}))}catch(r){if(console.error("Claim error:",r),r&&r.message&&r.message.toLowerCase().includes("unauthor"))return void ut.openAuthModal();wt({visible:!0,message:r.message||"Claim failed"}),ft(!1)}else ut.openAuthModal()},selectedLanguage:h}),t.jsx(J,{isOpen:tt,onClose:()=>st(!1),onUpgrade:()=>{st(!1),window.location.href="/sponsorship"},onClaimFree:()=>{st(!1)},selectedLanguage:h}),t.jsx(H,{isOpen:rt,onClose:()=>at(!1),onUpgrade:()=>{at(!1),window.location.href="/sponsorship"},onViewLowerValue:()=>{at(!1)},selectedLanguage:h}),kt&&t.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full p-8 animate-in fade-in scale-in",children:[t.jsx("div",{className:"flex items-center justify-center w-12 h-12 mx-auto rounded-full bg-red-100 mb-6",children:t.jsx(O,{className:"w-6 h-6 text-red-600"})}),t.jsx("h3",{className:"text-center text-lg font-bold text-gray-900 mb-2",children:"Delete Request?"}),t.jsx("p",{className:"text-center text-gray-600 mb-8 leading-relaxed",children:"This will permanently delete your request. This action cannot be undone."}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:async()=>{const t=localStorage.getItem("regaarder_token"),s=m();try{const a=await fetch(`${s}/requests/${e.id}`,{method:"DELETE",headers:{...t?{Authorization:`Bearer ${t}`}:{}}});if(!a.ok){const e=await a.json().catch(()=>({error:"Delete failed"}));if(400===a.status||e.error.includes("progress"))return St(!1),void wt({visible:!0,message:"This request is currently in progress and cannot be deleted."});throw new Error(e.error||"Delete failed")}St(!1),Nt(!1);try{window.dispatchEvent(new CustomEvent("request:deleted",{detail:{requestId:e.id}}))}catch(r){}wt({visible:!0,message:"Request deleted successfully"})}catch(a){console.error("Delete failed",a),St(!1),wt({visible:!0,message:a.message||"Delete failed"})}},className:"w-full px-4 py-3 rounded-lg bg-red-600 text-white font-semibold hover:bg-red-700 active:scale-95 transition-all",children:"Yes, delete it"}),t.jsx("button",{onClick:()=>St(!1),className:"w-full px-4 py-3 rounded-lg bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200 active:scale-95 transition-all",children:"Cancel"})]})]})}),t.jsx(oe,{message:fe.message,isVisible:fe.visible,onClose:()=>ye({...fe,visible:!1}),actionLabel:"Undo",onAction:()=>{xe&&("bookmark"===xe.type&&V(xe.prev),"dismiss"===xe.type&&(de.current&&(clearTimeout(de.current),de.current=null),me(!1),he(!0)),pe(null),ye({visible:!1,message:""}))},variant:"success"}),t.jsx(oe,{message:Qe.message,isVisible:Qe.visible,onClose:()=>Ke({...Qe,visible:!1}),variant:"success"}),t.jsx(oe,{message:vt.message,isVisible:vt.visible,onClose:()=>wt({visible:!1,message:""}),variant:"success"}),Ie&&t.jsxs("div",{ref:Le,style:$e,className:"z-40",onMouseEnter:()=>{Pe.current&&(clearTimeout(Pe.current),Pe.current=null)},onMouseLeave:()=>{Pe.current&&clearTimeout(Pe.current),Pe.current=setTimeout(()=>Ee(!1),4e3)},children:[t.jsx("style",{children:"\n                        @keyframes fadeScale { \n                            0% { opacity: 0; transform: translateY(6px) scale(0.98); }\n                            100% { opacity: 1; transform: translateY(0) scale(1); }\n                        }\n                    "}),t.jsxs("div",{className:"bg-white rounded-xl shadow-lg py-2 px-4 flex flex-col space-y-1 text-sm",style:{animation:"fadeScale 160ms ease-out forwards",minWidth:160},role:"menu","aria-label":"Quick actions",children:[t.jsxs("button",{onClick:()=>{if(!ut.user)return void ut.openAuthModal();const t="request_reacts_v1";Me(s=>{const r=!s;r?(ve(!1),nt(e=>Math.max(0,e-1)),ye({visible:!0,message:"Marked as disliked"})):ye({visible:!0,message:"Removed dislike"});try{const s=localStorage.getItem(t),a=s?JSON.parse(s):{};a[e.id]=a[e.id]||{},a[e.id].isDisliked=r,a[e.id].likesCount=a[e.id].likesCount||ot,a[e.id].isLiked=!r&&(a[e.id].isLiked||!1),localStorage.setItem(t,JSON.stringify(a))}catch(a){}return r});try{const t=ut.user&&ut.user.token||localStorage.getItem("regaarder_token"),s=Be?"undislike":"dislike";fetch(`${m()}/requests/react`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:`Bearer ${t}`}:{}},body:JSON.stringify({requestId:e.id,action:s})}).catch(()=>{})}catch(s){}Pe.current&&clearTimeout(Pe.current),Pe.current=setTimeout(()=>Ee(!1),1400)},className:"px-4 py-2 hover:bg-gray-100 rounded-md text-left w-full flex items-center",role:"menuitem","aria-label":"Dislike",children:[t.jsx(z,{className:"w-4 h-4 mr-3",style:{color:"var(--color-like)",fill:Be?"var(--color-like)":"none"}}),"Dislike"]}),t.jsxs("button",{onClick:()=>{if(n)ns(!0);else{try{"function"==typeof i&&i()}catch(e){}Ee(!1)}},className:"px-4 py-2 hover:bg-gray-100 rounded-md text-left w-full flex items-center",role:"menuitem","aria-label":"Pin",children:[t.jsx(R,{className:"w-4 h-4 mr-3",style:{color:n?"var(--color-gold)":"#9CA3AF",fill:n?"var(--color-gold)":"none"}}),"Pin"]}),t.jsxs("button",{onClick:()=>{Fe(!0)},className:"px-4 py-2 hover:bg-gray-100 rounded-md text-left w-full flex items-center",role:"menuitem","aria-label":"Report",children:[t.jsx(D,{className:"w-4 h-4 mr-3",style:{color:"#9CA3AF"}}),"Report"]}),t.jsxs("button",{onClick:()=>{Ue(!0)},className:"px-4 py-2 hover:bg-gray-100 rounded-md text-left w-full flex items-center",role:"menuitem","aria-label":"Share",children:[t.jsx(U,{className:"w-4 h-4 mr-3",style:{color:"var(--color-gold)"}}),"Share"]})]})]}),Oe&&t.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Fe(!1)}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 relative z-10 w-full max-w-sm",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:r("Report request",h)}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r("Please select a reason for reporting â€” this helps our moderation team prioritize reviews.",h)}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"radio",name:"reportReason",value:"spam",checked:"spam"===Ve,onChange:()=>We("spam")}),t.jsx("span",{className:"text-sm",children:r("Spam or misleading",h)})]}),t.jsxs("label",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"radio",name:"reportReason",value:"harassment",checked:"harassment"===Ve,onChange:()=>We("harassment")}),t.jsx("span",{className:"text-sm",children:r("Harassment or hate",h)})]}),t.jsxs("label",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"radio",name:"reportReason",value:"inaccurate",checked:"inaccurate"===Ve,onChange:()=>We("inaccurate")}),t.jsx("span",{className:"text-sm",children:r("Inaccurate or harmful information",h)})]}),t.jsxs("label",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"radio",name:"reportReason",value:"other",checked:"other"===Ve,onChange:()=>We("other")}),t.jsx("span",{className:"text-sm",children:r("Other",h)})]}),"other"===Ve&&t.jsx("textarea",{value:Xe,onChange:e=>Ge(e.target.value),placeholder:r("Optional: tell us more (max 200 chars)",h),maxLength:200,className:"w-full mt-2 p-2 border border-gray-200 rounded-md text-sm"})]}),t.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[t.jsx("button",{onClick:()=>Fe(!1),className:"px-4 py-2 rounded-full bg-gray-100",children:r("Cancel",h)}),t.jsx("button",{onClick:()=>{Fe(!1),Ee(!1);ye({visible:!0,message:`Reported â€” ${"other"===Ve?Xe||"Other":Ve}`})},className:"px-4 py-2 rounded-full",style:{backgroundColor:"var(--color-gold)",color:"#fff"},children:r("Report",h)})]})]})]}),ze&&t.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Ue(!1)}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 relative z-10 w-full max-w-sm",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:r("Share request",h)}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r("Share this request with others.",h)}),t.jsxs("div",{className:"flex flex-col space-y-3",children:[t.jsx("button",{onClick:async()=>{const t=`${g}/share/request/${encodeURIComponent(e.id)}`;try{if(navigator&&navigator.share)return await navigator.share({title:e.title,text:`${e.title}\n${t}`,url:t}),ye({visible:!0,message:"Shared"}),Ue(!1),void Ee(!1)}catch(s){console.error("navigator.share failed",s)}await ls()},className:"px-4 py-2 rounded-full text-left",style:{backgroundColor:"#f3f4f6"},children:r("Share via device",h)}),t.jsx("button",{onClick:ls,className:"px-4 py-2 rounded-full text-left bg-gray-100",children:r("Copy link",h)})]}),t.jsx("div",{className:"flex justify-end mt-4",children:t.jsx("button",{onClick:()=>Ue(!1),className:"px-4 py-2 rounded-full bg-white border",children:r("Close",h)})})]})]}),os&&t.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:is}),t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 relative z-10 w-full max-w-sm",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:"Unpin request?"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Are you sure you want to remove this request from your pinned items? It will no longer appear at the top of your feed."}),t.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[t.jsx("button",{onClick:is,className:"px-4 py-2 rounded-full bg-gray-100",children:"Cancel"}),t.jsx("button",{onClick:()=>{try{"function"==typeof i&&i()}catch(e){}ns(!1),Ee(!1)},className:"px-4 py-2 rounded-full",style:{backgroundColor:"var(--color-gold)",color:"#fff"},children:"Unpin"})]})]})]}),t.jsx(oe,{message:"Youâ€™ve successfully claimed this request. You now have 48 hours to provide an update or draft.",isVisible:yt,onClose:()=>bt(!1)})]})},ie=({name:e,username:s,isCreator:o=!1,onClose:n,profileData:i=null,selectedLanguage:c="English",onNavigateToIdeas:u=null})=>{const g=(new Date).getFullYear(),[h,x]=d.useState(null);d.useEffect(()=>{if(i&&i.avatar)return void x(i);(async()=>{try{const t=s||e,r=m(),a=await fetch(`${r}/users`),o=await a.json(),n=(Array.isArray(o.users)?o.users:Array.isArray(o)?o:[]).find(e=>e.id===t||e.email===t||e.name===t||e.name&&e.name.toLowerCase()===String(t).toLowerCase());x(n?{...i,avatar:n.image||n.avatar||null}:i)}catch(t){console.error("Error fetching user profile:",t),x(i)}})()},[s,e,i]);const p=h||i||{avatar:null,bio:r(o?"Creating engaging content for you":"Enjoying great content",c),stats:{videos:o?24:0,requests:12,followers:1245},verified:!1,joinedDate:g},f=a(),[y,b]=d.useState(!1);return d.useEffect(()=>{try{const e=i&&i.id||null,t=f.user&&f.user.token||localStorage.getItem("regaarder_token");if(!e||!t)return;fetch(`${m()}/following/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(e=>e.json()).then(e=>{void 0!==e.isFollowing&&b(!!e.isFollowing)}).catch(()=>{})}catch(e){}},[i&&i.id,f.user&&f.user.token]),t.jsx("div",{className:"fixed inset-0 z-[130] flex items-center justify-center px-4",style:{backgroundColor:"rgba(0,0,0,0.6)"},onClick:n,children:t.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-2xl",onClick:e=>e.stopPropagation(),children:[t.jsx("div",{className:"relative h-24",style:{background:"linear-gradient(135deg, rgba(203,138,0,0.1) 0%, rgba(203,138,0,0.05) 100%)"}}),t.jsxs("div",{className:"px-6 pb-6 -mt-12",children:[t.jsxs("div",{className:"relative inline-block",children:[t.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-lg flex items-center justify-center overflow-hidden",style:{background:p.avatar?"transparent":"linear-gradient(135deg, #e5e7eb 0%, #f3f4f6 100%)"},children:p.avatar?t.jsx("img",{src:p.avatar,alt:e,className:"w-full h-full object-cover"}):t.jsx(P,{className:"w-12 h-12 text-gray-400"})}),o&&p.verified&&t.jsx("div",{className:"absolute bottom-0 right-0 w-7 h-7 rounded-full border-2 border-white flex items-center justify-center shadow-md",style:{backgroundColor:"var(--color-gold)"},children:t.jsx(l,{className:"w-3.5 h-3.5 text-white"})})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:e}),o&&t.jsx("div",{className:"px-2 py-0.5 rounded-full text-xs font-semibold text-white",style:{backgroundColor:"var(--color-gold)"},children:r("Creator",c)})]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["@",s||e.replace(/\s+/g,"").toLowerCase()]})]}),p.bio&&t.jsx("p",{className:"text-sm text-gray-600 mt-3 leading-relaxed",children:p.bio}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6 py-4 border-y border-gray-100",children:[o&&t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-xl font-bold text-gray-900",children:p.stats.videos}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r("Videos",c)})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-xl font-bold text-gray-900",children:p.stats.requests}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r(o?"Fulfilled":"Requested",c)})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-xl font-bold text-gray-900",children:p.stats.followers>=1e3?`${(p.stats.followers/1e3).toFixed(1)}k`:p.stats.followers}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r("Followers",c)})]})]}),t.jsxs("div",{className:"mt-6 space-y-3",children:[t.jsx("button",{onClick:()=>{const e=i&&i.id||null,t=f.user&&f.user.token||localStorage.getItem("regaarder_token");if(!e||!t)return void(n&&n());const s=y?"/unfollow":"/follow";fetch(`${m()}${s}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({creatorId:e})}).then(e=>e.json()).then(()=>b(!y)).catch(()=>{})},className:"w-full py-3 rounded-xl font-semibold text-white transition-all hover:opacity-90 shadow-md",style:{backgroundColor:"var(--color-gold)",boxShadow:"0 4px 12px rgba(203, 138, 0, 0.3)"},children:r(y?"Following":"Follow",c)}),o&&t.jsx("button",{onClick:async e=>{e.preventDefault(),e.stopPropagation();const t={id:p.id||(p.handle||p.tag||String(p.name||"").replace(/^@+/,"")).toLowerCase(),name:p.handle?`@${p.handle}`:p.name||"",handle:p.handle,image:p.image||null};window.localStorage.setItem("ideas_selectedCreator_v1",JSON.stringify(t)),u&&"function"==typeof u?u():(n&&n(),await new Promise(e=>setTimeout(e,10)),window.dispatchEvent(new CustomEvent("ideas:creator_selected")),window.setFooterTab?(window.setFooterTab("ideas"),window.history.pushState({},"","/ideas")):window.location.href="/ideas")},className:"w-full py-3 rounded-xl border-2 font-semibold transition-all hover:bg-gray-50",style:{borderColor:"var(--color-gold)",color:"var(--color-gold)"},children:r("Request Video",c)})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsxs("p",{className:"text-xs text-gray-400",children:[r("Member since",c)," ",p.joinedDate]})})]})]})})};function le(){const e=a(),s=c(),{selectedLanguage:l}=o(),[u,g]=d.useState(()=>{try{const e=new URLSearchParams(window.location.search).get("filter");if(["For You","Trending","Newest","Top Funded","Completed"].includes(e))return e}catch(e){}return"For You"}),[h,x]=d.useState("Requests"),[p,y]=d.useState(""),[I,A]=d.useState(null),[L,$]=d.useState(new Set),[R,D]=d.useState(!1),[_,B]=d.useState("All"),[M,O]=d.useState("All Time"),[F,z]=d.useState("All"),[U,P]=d.useState(null),[J,H]=d.useState((new Date).getMonth()),[X,G]=d.useState((new Date).getFullYear()),[Q,K]=d.useState(!1),[Z,te]=d.useState(!1),[se,re]=d.useState(null),[ae,le]=d.useState(()=>{try{return"true"===localStorage.getItem("hideClaimedRequests")}catch(e){return!1}}),[ce,de]=d.useState(()=>{try{return parseInt(localStorage.getItem("hideClaimedHintCount")||"0",10)}catch(e){return 0}}),[ue,me]=d.useState(!1),[ge,he]=d.useState(()=>{try{const e=localStorage.getItem("requestAccentColorSelection");return e?JSON.parse(e):{}}catch(e){return{}}}),xe=d.useRef(null);d.useEffect(()=>{try{const e=parseInt(localStorage.getItem("hideClaimedHintCount")||"0",10);if(e<2){me(!0);const t=e+1;de(t),localStorage.setItem("hideClaimedHintCount",String(t))}}catch(e){}},[]),d.useEffect(()=>{const e=setInterval(()=>{try{const e=localStorage.getItem("requestAccentColorSelection"),t=e?JSON.parse(e):{};he(e=>JSON.stringify(t)!==JSON.stringify(e)?t:e)}catch(e){}},500),t=e=>{e.detail&&he(e.detail)},s=e=>{if("requestAccentColorSelection"===e.key)try{const t=e.newValue?JSON.parse(e.newValue):{};he(t)}catch(t){console.error("Failed to parse admin selections:",t)}};return window.addEventListener("adminSelectionChanged",t),window.addEventListener("storage",s),()=>{clearInterval(e),window.removeEventListener("adminSelectionChanged",t),window.removeEventListener("storage",s)}},[]),d.useEffect(()=>{try{const e=new URLSearchParams(s.search).get("filter");e&&["For You","Trending","Newest","Top Funded","Completed"].includes(e)&&g(e)}catch(e){}},[s.search]),d.useEffect(()=>{(()=>{try{const e=new URLSearchParams(window.location.search||""),t=e.get("q");t&&y(t);const s=e.get("id");s&&(fe(String(s)),setTimeout(()=>{try{const e=document.querySelector(`[data-request-id="${String(s)}"]`);e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"center"})}catch(e){}},800))}catch(e){}})()},[]);const[pe,fe]=d.useState(null),ye=e=>{const t=e.map(e=>({...e,totalInfluence:e.likes+2*e.boosts})),s=[...t].sort((e,t)=>t.totalInfluence-e.totalInfluence),r={};return s.forEach((e,t)=>{const a=t+1;let o=null;a>1&&(o=s[t-1].totalInfluence);const n=null!==o?o-e.totalInfluence+1:0,i=s.slice(t+1).filter(t=>e.totalInfluence-t.totalInfluence<=20).length;r[e.id]={rank:a,nextRankNeeded:n,nextRankScore:o,threatCount:i,totalInfluence:e.totalInfluence}}),t.map(e=>{const t=r[e.id]||{rank:999,nextRankNeeded:0,threatCount:0};return{...e,...t,pinned:e.pinned||!1,pinnedAt:e.pinnedAt||null}})},[be,ve]=d.useState(()=>{const e=ye([]);try{const t=localStorage.getItem("pinned_requests_v1");if(t){const s=JSON.parse(t),r=e.map(e=>({...e,pinned:!!s[e.id],pinnedAt:s[e.id]||null})),a=r.filter(e=>e.pinned).sort((e,t)=>(t.pinnedAt||0)-(e.pinnedAt||0)),o=r.filter(e=>!e.pinned);return[...a,...o]}}catch(t){}return e});d.useEffect(()=>{console.log(`DEBUG: RankedRequests update. Count=${be.length}`);const e=be.filter(e=>e.isOptimistic);e.length>0&&console.warn("DEBUG: Found OPTIMISTIC requests in list:",e.map(e=>e.id)),console.log("DEBUG: Top 3 IDs:",be.slice(0,3).map(e=>e.id))},[be]),d.useEffect(()=>{let e=!1;return(async()=>{try{const s=m(),r=localStorage.getItem("regaarder_token");let a=new Set;try{const e=await fetch(`${s}/bookmarks`,{headers:r?{Authorization:`Bearer ${r}`}:{}}),t=await e.json();t&&t.success&&Array.isArray(t.requests)&&(t.requests.forEach(e=>{e.requestId&&(console.log("Bookmarked requestId:",e.requestId),a.add(String(e.requestId)))}),console.log("Bookmarked request IDs set:",Array.from(a)))}catch(t){console.warn("Failed to fetch request bookmarks:",t)}const o={"For You":"recommended",Trending:"trending",Newest:"fresh","Top Funded":"funded",Completed:"completed"}[u]||"recommended",n=new URL(`${s}/requests`);n.searchParams.set("feed",o),_&&"All"!==_&&n.searchParams.set("category",_);const i=await fetch(n.toString());if(console.log("[REQUESTS_FETCH] URL:",n.toString(),"status:",i.status),!i.ok)throw new Error("Failed to fetch requests");const l=await i.json();if(console.log("[REQUESTS_FETCH] Backend returned:",l.requests?.length||0,"requests"),window.__DEBUG_REQUESTS_COUNT=l.requests?.length||0,e)return;let c=Array.isArray(l.requests)?l.requests:[];c=(e=>{let r=[...e];try{const e=localStorage.getItem("ideas_requests_v1");if(e){console.log("Found local optimistic requests:",e.length,"chars");const a=JSON.parse(e);if(console.log("Local requests parsed:",a.length,"items"),Array.isArray(a)){const e=new Set(r.map(e=>String(e.id))),o=a.filter(t=>!(!t||!t.id)&&!e.has(String(t.id)));if(console.log("Merging missing optimistic requests:",o.length),o.length>0){const e=o.map(e=>({...e,isOptimistic:!0,likes:e.likes||0,boosts:e.boosts||0,comments:e.comments||0,funding:e.funding||e.amount||0}));e.sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)),r=[...e,...r],setTimeout(()=>{e.forEach(async e=>{if(!e||e.backendSynced)return;const r=`sync_attempt_${e.id}`;if(!sessionStorage.getItem(r)){sessionStorage.setItem(r,"1"),console.log("Self-healing: Syncing missing request to backend",e.id);try{const t=localStorage.getItem("regaarder_token"),a={"Content-Type":"application/json"};t&&(a.Authorization=`Bearer ${t}`);const o=t?`${s}/requests`:`${s}/requests/public`,n={id:e.id,title:e.title,description:e.description,creator:e.creator,createdBy:e.createdBy||(e.creator?e.creator.id:null),meta:e.meta,amount:e.amount||e.funding||0},i=await fetch(o,{method:"POST",headers:a,body:JSON.stringify(n)});i.ok?console.log("Self-healing: Successfully synced",e.id):(console.warn("Self-healing: Failed to sync",e.id,i.status),sessionStorage.removeItem(r))}catch(t){console.error("Self-healing error",t),sessionStorage.removeItem(r)}}})},2e3)}}}}catch(t){console.warn("Failed to merge local requests:",t)}return console.log("processLocalRequests returning:",r.length,"total requests"),r})(c);let d=c.map(e=>{const s={likes:0,boosts:0,comments:0,funding:0,...e};s.funding="number"==typeof s.funding&&s.funding>0?s.funding:"number"==typeof s.amount?s.amount:0;const r=s.creator&&"object"==typeof s.creator?s.creator:null,o=r&&(r.id||r.userId)||s.creatorId||s.createdBy||("string"==typeof s.creator?s.creator:null),n=s.requesterName||s.requester||s.createdByName||s.creatorName||r&&(r.name||r.handle||r.tag)||s.company||"Community",i=s.requesterAvatar||s.requesterImage||s.avatar||s.photoURL||r&&(r.image||r.avatar||r.photoURL)||s.imageUrl||"";s.creator=r||{id:o||null,name:n,image:i||""},s.requesterName=n,s.requesterAvatar=i||"",s.company=s.company||n,s.companyInitial=s.companyInitial||(s.company?String(s.company).charAt(0).toUpperCase():"C"),s.companyColor=s.companyColor||"bg-gray-400",s.imageUrl=s.imageUrl||i||"",s.timeAgo=s.timeAgo||(e=>{try{if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const s=Date.now()-t.getTime(),r=Math.floor(s/1e3);if(r<60)return"Just now";const a=Math.floor(r/60);if(a<60)return`${a}m ago`;const o=Math.floor(a/60);if(o<24)return`${o}h ago`;const n=Math.floor(o/24);if(n<7)return`${n}d ago`;const i=Math.floor(n/7);return i<4?`${i}w ago`:t.toLocaleDateString()}catch(t){return""}})(s.createdAt);const l=a.has(String(s.id));return console.log(`Request ${s.id} bookmarked:`,l),s.bookmarked=l,s});try{const e=Array.from(new Set(d.filter(e=>e.creator&&e.creator.id).map(e=>e.creator.id)));if(e.length>0){const s=(await Promise.all(e.map(async e=>{try{const t=await fetch(`${m()}/users/${e}`);if(!t.ok)return null;const s=await t.json();return s&&s.user?s.user:null}catch(t){return null}}))||[]).reduce((e,t)=>(t&&t.id&&(e[t.id]=t),e),{});d=d.map(e=>{if(e.creator&&e.creator.id&&s[e.creator.id]){const t=s[e.creator.id];e.creator={...e.creator,...t},e.imageUrl=e.imageUrl||t.image||t.avatar||"",e.company=e.company||t.name||e.creator.name||e.creator.id,e.companyInitial=e.companyInitial||(e.company?String(e.company).charAt(0).toUpperCase():"C")}return e})}}catch(t){}"Top Funded"===u?d.sort((e,t)=>(t.funding||0)-(e.funding||0)):"Newest"===u&&d.sort((e,t)=>{const s=e.createdAt?new Date(e.createdAt).getTime():0,r=t.createdAt?new Date(t.createdAt).getTime():0;return isNaN(s)||isNaN(r)?0:r-s});const g=ye(d);try{const e=localStorage.getItem("pinned_requests_v1");if(e){const t=JSON.parse(e),s=g.map(e=>({...e,pinned:!!t[e.id],pinnedAt:t[e.id]||null})),r=s.filter(e=>e.pinned).sort((e,t)=>(t.pinnedAt||0)-(e.pinnedAt||0)),a=s.filter(e=>!e.pinned);return console.log("ðŸ”´ SETTING rankedRequests with pinned:",[...r,...a].length),void ve([...r,...a])}}catch(t){}console.log("ðŸ”´ SETTING rankedRequests (no pins):",g.length),ve(g)}catch(t){console.error("ðŸ”´ðŸ”´ðŸ”´ FETCH ERROR:",t);try{const e=void 0!==import.meta&&W&&!1;let t=ye(e?ee:[]);try{const s=localStorage.getItem("ideas_requests_v1");if(s){const r=JSON.parse(s);if(Array.isArray(r)&&r.length>0){const s=r.map(e=>({...e,likes:0,boosts:0,comments:0,funding:e.amount||0,isOptimistic:!0,company:e.company||(e.creator?e.creator.name:"Me"),companyInitial:"M",companyColor:"bg-gray-400",timeAgo:"Just now",imageUrl:e.imageUrl||""}));t=ye([...s,...e?ee:[]])}}}catch(s){}ve(t)}catch(r){}}})(),()=>{e=!0}},[u,_,F,s.search]),d.useEffect(()=>{const e=e=>{try{const t=e&&e.detail?e.detail:null;if(!t)return;console.log("RequestsFeed: received ideas:request_created",t),ve(e=>{const s={likes:0,boosts:0,comments:0,funding:0,...t};if(e.some(e=>e.id===s.id))return e;const r=[s,...e.map(e=>({...e}))];return ye(r)})}catch(t){}};return window.addEventListener("ideas:request_created",e),()=>window.removeEventListener("ideas:request_created",e)},[]),d.useEffect(()=>{const e=e=>{try{const{requestId:t,claimedBy:s,claimedAt:r}=e.detail||{};if(!t)return;ve(e=>e.map(e=>e.id===t?{...e,claimed:!0,claimedBy:s,claimedAt:r}:e))}catch(t){}};return window.addEventListener("request:claimed",e),()=>window.removeEventListener("request:claimed",e)},[]),d.useEffect(()=>{const e=e=>{try{const{requestId:t}=e&&e.detail?e.detail:{};if(console.log("RequestsFeed: received comment_added",{requestId:t,detail:e&&e.detail}),null==t)return;ve(e=>e.map(e=>String(e.id)===String(t)?{...e,comments:(Number(e.comments)||0)+1}:e))}catch(t){console.warn("RequestsFeed: error handling comment_added",t)}},t=e=>{try{const{requestId:t}=e&&e.detail?e.detail:{};if(console.log("RequestsFeed: received comment_updated",{requestId:t,detail:e&&e.detail}),null==t)return;ve(e=>e.map(e=>String(e.id)===String(t)?{...e}:e))}catch(t){console.warn("RequestsFeed: error handling comment_updated",t)}},s=e=>{try{const{requestId:t}=e&&e.detail?e.detail:{};if(console.log("RequestsFeed: received comment_deleted",{requestId:t,detail:e&&e.detail}),null==t)return;ve(e=>e.map(e=>String(e.id)===String(t)?{...e,comments:Math.max(0,(Number(e.comments)||0)-1)}:e))}catch(t){console.warn("RequestsFeed: error handling comment_deleted",t)}};return window.addEventListener("request:comment_added",e),window.addEventListener("request:comment_updated",t),window.addEventListener("request:comment_deleted",s),()=>{window.removeEventListener("request:comment_added",e),window.removeEventListener("request:comment_updated",t),window.removeEventListener("request:comment_deleted",s)}},[]),d.useEffect(()=>{const e=e=>{try{const t=e&&e.detail&&e.detail.request?e.detail.request:null;if(!t||!t.id)return;ve(e=>e.map(e=>String(e.id)===String(t.id)?{...e,...t}:e))}catch(t){console.warn("RequestsFeed: error handling request:updated",t)}};return window.addEventListener("request:updated",e),()=>window.removeEventListener("request:updated",e)},[]),d.useEffect(()=>{try{const t=e.user&&e.user.token||localStorage.getItem("regaarder_token");if(!t)return;fetch(`${m()}/requests/react/me`,{headers:{Authorization:`Bearer ${t}`}}).then(e=>e.json()).then(e=>{if(e&&e.reactions)try{const t=localStorage.getItem("request_reacts_v1"),s={...t?JSON.parse(t):{},...e.reactions};localStorage.setItem("request_reacts_v1",JSON.stringify(s))}catch(t){}}).catch(()=>{})}catch(t){}},[e.user&&e.user.token]),d.useEffect(()=>{(()=>{if(!be||0===be.length)return;const e=new Date((new Date).getTime()-1296e5);localStorage.getItem("regaarder_token");let t=null;try{const e=localStorage.getItem("regaarder_user");if(e){t=JSON.parse(e).id}}catch(s){}for(const r of be){const a=!r.amount||0===r.amount,o=new Date(r.createdAt||r.timestamp)<=e,n=0===(r.likes||0)&&0===(r.boosts||0)&&0===(r.comments||0)&&0===(r.bookmarks||0)&&0===(r.views||0),i=t&&String(r.createdBy)===String(t);try{if(localStorage.getItem(`nudge_shown_${r.id}`))continue}catch(s){}if(a&&o&&n&&i){re(r),te(!0);try{localStorage.setItem(`nudge_shown_${r.id}`,"true")}catch(s){}break}}})()},[be]);const[we,je]=d.useState({visible:!1,message:""});d.useEffect(()=>{let t=!1;const s=async()=>{try{const s=e.user&&e.user.token||localStorage.getItem("regaarder_token"),r=s?{Authorization:`Bearer ${s}`}:{},a=await fetch(`${m()}/bookmarks`,{headers:r}),o=await a.json();if(!t&&o&&o.success){const e=new Set((Array.isArray(o.requests)?o.requests:[]).map(e=>String(e.requestId)));$(e),ve(t=>t.map(t=>({...t,bookmarked:e.has(String(t.id))})))}}catch(s){console.warn("Failed to sync request bookmarks:",s)}};s();const r=setInterval(s,5e3);return()=>{t=!0,clearInterval(r)}},[e.user]),d.useEffect(()=>{try{const e=localStorage.getItem("requests:navigateTo");e&&(fe(String(e)),setTimeout(()=>{try{const t=document.querySelector(`[data-request-id="${String(e)}"]`);t&&t.scrollIntoView&&t.scrollIntoView({behavior:"smooth",block:"center"})}catch{}},600),localStorage.removeItem("requests:navigateTo"))}catch{}},[]);const[Ne,ke]=d.useState(!1),[Se,Ce]=d.useState(null),[qe,Te]=d.useState(!1),[Ie,Ee]=d.useState(null),Ae=(e,t=!1,s=null)=>{Ce(e),Te(t),Ee(s),ke(!0)};d.useEffect(()=>{if(!R)return;const e=e=>{xe.current&&!xe.current.contains(e.target)&&D(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[R]);const[Le,$e]=d.useState(!1);d.useEffect(()=>{try{localStorage.getItem("requests_swipe_entrance_shown")||$e(!0)}catch(e){}},[]);const Re=()=>{try{localStorage.setItem("requests_swipe_entrance_shown","1")}catch(e){}$e(!1)},De=Array.isArray(be)&&be.some(e=>e.isTrending);d.useEffect(()=>{De||"Trending"!==u||g("Newest")},[De,u]);const _e=[{name:"For You",Icon:S},{name:"Newest",Icon:C},{name:"Trending",Icon:b},{name:"Top Funded",Icon:q},{name:"Completed",Icon:T},{name:"Following",Icon:E}];let Be=be.filter(e=>{if(!e||!e.id)return!1;if(e.hidden||e.deleted)return!1;if(!p.trim())return!0;const t=p.trim().toLowerCase();return(e.title||"").toLowerCase().includes(t)||(e.description||"").toLowerCase().includes(t)||(e.company||"").toLowerCase().includes(t)});Be=(t=>{let s=t;if(ae&&(s=s.filter(e=>!e.claimed&&!e.claimedBy)),"All"!==_&&(s=s.filter(e=>(e.category||"General")===_)),U)s=s.filter(e=>{if(!e.createdAt)return!1;const t=new Date(e.createdAt),s=new Date(U);return t.toDateString()===s.toDateString()});else if("All Time"!==M){const e=Date.now();s=s.filter(t=>{const s=t.createdAt?new Date(t.createdAt).getTime():e,r=(e-s)/864e5;return"Today"===M?r<1:"This Week"===M?r<7:"This Month"!==M||r<30})}switch("All"!==F&&("Completed"===F?s=s.filter(e=>!0===e.isCompleted):"Active"===F&&(s=s.filter(e=>!e.isCompleted))),u){case"For You":try{let t=e&&e.user&&e.user.id?String(e.user.id):null;if(!t)try{const e=localStorage.getItem("regaarder_user");if(e){const s=JSON.parse(e);s&&s.id&&(t=String(s.id))}}catch(r){}return t?[...s].sort((e,s)=>{if(e.isOptimistic&&!s.isOptimistic)return-1;if(s.isOptimistic&&!e.isOptimistic)return 1;const r=String(e.createdBy||e.creator&&e.creator.id)===t?1:0,a=(String(s.createdBy||s.creator&&s.creator.id)===t?1:0)-r;return 0!==a?a:new Date(s.createdAt)-new Date(e.createdAt)}):[...s].sort((e,t)=>e.isOptimistic&&!t.isOptimistic?-1:t.isOptimistic&&!e.isOptimistic?1:new Date(t.createdAt)-new Date(e.createdAt))}catch(r){console.warn("Sort For You failed",r)}return s;case"Trending":case"Following":default:return s;case"Newest":return[...s].sort((e,t)=>{const s=e.createdAt?new Date(e.createdAt).getTime():0,r=t.createdAt?new Date(t.createdAt).getTime():0;return isNaN(s)||isNaN(r)?0:r-s});case"Top Funded":return[...s].sort((e,t)=>t.funding-e.funding);case"Completed":return s.filter(e=>!0===e.isCompleted)}})(Be),d.useEffect(()=>{let e=null;try{const s=new URLSearchParams(window.location.search||""),r=s.get("reqId");let a=s.get("focus")||r||null;if(!a&&p){const e=p.toLowerCase(),t=be.find(t=>(t.title||"").toLowerCase().includes(e)||(t.company||"").toLowerCase().includes(e));t&&(a=t.id)}if(!a){const e=localStorage.getItem("focus_request_hint");if(e){const t=JSON.parse(e),s=be.find(e=>(e.title||"").toLowerCase().includes((t.title||"").toLowerCase())||(e.company||"").toLowerCase()===(t.requester||"").toLowerCase());s&&(a=s.id)}}if(a){const s=String(a);A(s);const r=document.getElementById(`request-card-${s}`);r&&r.scrollIntoView({behavior:"smooth",block:"center"});try{localStorage.removeItem("focus_request_hint")}catch(t){}e=setTimeout(()=>A(null),3500)}}catch(t){}return()=>{e&&clearTimeout(e)}},[be,p]);return t.jsxs("div",{className:"min-h-screen bg-gray-50 pb-32 app-container-light",children:[t.jsxs("header",{className:"sticky top-0 bg-white shadow-sm z-20 pb-2 border-b border-gray-100",style:{paddingTop:"calc(12px + env(safe-area-inset-top, 0px))",marginBottom:"4px"},children:[t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(w,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"text",placeholder:r("Search requests...",l),value:p,onChange:e=>y(e.target.value),className:"w-full py-3 pl-10 pr-24 bg-gray-100 border border-gray-200 rounded-xl focus:outline-none focus:ring-1 focus:ring-gray-300 text-gray-700 placeholder-gray-500 text-base","aria-label":r("Search requests...",l)}),t.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-2",children:[p&&t.jsx("button",{onClick:()=>y(""),"aria-label":"Clear search",className:"p-1 rounded-full text-gray-500 hover:text-gray-800 hover:bg-gray-200 transition",children:t.jsx(f,{className:"w-4 h-4"})}),t.jsxs("button",{onClick:()=>D(!R),"aria-label":"Advanced filters",className:"p-1.5 rounded-full text-gray-500 hover:text-gray-800 hover:bg-gray-200 transition relative",style:{backgroundColor:"All"!==_||"All Time"!==M||"All"!==F||U?"var(--color-gold-light)":"transparent",color:"All"!==_||"All Time"!==M||"All"!==F||U?"var(--color-gold)":"#6b7280"},children:[t.jsx(Y,{className:"w-5 h-5"}),("All"!==_||"All Time"!==M||"All"!==F||U)&&t.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 rounded-full",style:{backgroundColor:"var(--color-gold)"}})]}),t.jsxs("button",{onClick:()=>{le(!ae),localStorage.setItem("hideClaimedRequests",!ae)},"aria-label":ae?"Show claimed requests":"Hide claimed requests",title:ae?"Show claimed requests":"Hide claimed requests",className:"p-1.5 rounded-full text-gray-500 hover:text-gray-800 hover:bg-gray-200 transition relative",style:{backgroundColor:ae?"var(--color-gold-light)":"transparent",color:ae?"var(--color-gold)":"#6b7280",...ue&&{boxShadow:"0 0 0 0 rgba(202, 138, 4, 0.7)",animation:"pulse-hint 2s infinite"}},children:[ae?t.jsx(n,{className:"w-5 h-5"}):t.jsx(i,{className:"w-5 h-5"}),ue&&t.jsxs("div",{className:"absolute top-full mt-3 right-0 w-64 max-w-[80vw] bg-white rounded-xl shadow-2xl border-2 p-4 z-50 animate-fade-in-up",style:{borderColor:"var(--color-gold)",backgroundColor:"var(--color-gold)"},children:[t.jsx("div",{className:"absolute -top-2 right-6 w-4 h-4 rotate-45",style:{backgroundColor:"var(--color-gold)",borderLeft:"2px solid var(--color-gold)",borderTop:"2px solid var(--color-gold)"}}),t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-xs font-bold text-white flex items-center gap-1",children:[t.jsx("span",{children:"ðŸ‘ï¸"})," Hide Claimed Requests"]}),t.jsx("p",{className:"text-xs text-white mt-2 leading-snug font-medium whitespace-normal break-words",children:"Click the eye icon to focus on available requests and hide the ones already claimed by others"})]}),t.jsx("button",{onClick:()=>me(!1),className:"text-white hover:text-gray-100 flex-shrink-0 mt-0.5 font-bold text-lg leading-none opacity-80 hover:opacity-100 transition","aria-label":"Close hint",children:"Ã—"})]})]})]})]})]}),R&&t.jsxs("div",{ref:xe,className:"absolute right-4 mt-2 w-72 bg-white rounded-2xl shadow-2xl border border-gray-100 z-30 overflow-hidden",style:{maxHeight:"380px"},children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 bg-white sticky top-0 z-10",children:[t.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center",children:[t.jsx(Y,{className:"w-5 h-5 mr-2",style:{color:"var(--color-gold)"}}),r("Filters",l)]}),t.jsx("button",{onClick:()=>D(!1),className:"text-gray-500 hover:text-gray-900 p-1 rounded-full transition-colors",children:t.jsx(f,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"overflow-y-auto p-4 pt-2",style:{maxHeight:"280px"},children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:r("Category",l)}),t.jsx("div",{className:"space-y-1.5",children:["All","Technology","Education","Entertainment","Documentary","Review"].map(e=>t.jsxs("button",{onClick:()=>B(e),className:"w-full text-left px-3 py-2 rounded-lg text-sm transition-all "+(_===e?"font-semibold":"text-gray-600 hover:bg-gray-50"),style:{backgroundColor:_===e?"var(--color-gold-light)":"transparent",color:_===e?"var(--color-gold)":"#4b5563"},children:[_===e&&t.jsx(j,{className:"w-4 h-4 inline mr-2"}),r(e,l)]},e))})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("label",{className:"text-sm font-semibold text-gray-700 mb-2 block flex items-center justify-between",children:[t.jsxs("span",{className:"flex items-center",children:[t.jsx(N,{className:"w-4 h-4 mr-1.5"}),r("Date",l)]}),U&&t.jsx("button",{onClick:()=>P(null),className:"text-xs text-gray-500 hover:text-gray-700",children:r("Clear",l)})]}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-2",children:(()=>{const e=new Date,s=new Date(X,J,1),a=new Date(X,J+1,0).getDate(),o=s.getDay(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=[];for(let t=0;t<o;t++)i.push(null);for(let t=1;t<=a;t++)i.push(t);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("button",{onClick:()=>{0===J?(H(11),G(X-1)):H(J-1)},className:"p-1 hover:bg-gray-200 rounded transition-colors","aria-label":"Previous month",children:t.jsx(k,{className:"w-4 h-4 transform rotate-90"})}),t.jsxs("button",{onClick:()=>K(!Q),className:"text-center font-bold text-xs text-gray-700 hover:bg-gray-200 px-3 py-1 rounded transition-colors",children:[r(n[J],l)," ",X]}),t.jsx("button",{onClick:()=>{11===J?(H(0),G(X+1)):H(J+1)},className:"p-1 hover:bg-gray-200 rounded transition-colors","aria-label":"Next month",children:t.jsx(k,{className:"w-4 h-4 transform -rotate-90"})})]}),Q&&t.jsxs("div",{className:"mb-3 bg-white rounded-lg p-3 shadow-lg border border-gray-200",children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:r("Month",l)}),t.jsx("div",{className:"grid grid-cols-4 gap-1",children:n.map((e,s)=>t.jsx("button",{onClick:()=>{H(s),K(!1)},className:"px-2 py-1.5 text-xs rounded transition-all "+(J===s?"font-bold shadow-sm":"hover:bg-gray-100"),style:{backgroundColor:J===s?"var(--color-gold)":"transparent",color:J===s?"white":"#374151"},children:r(e,l)},s))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:r("Year",l)}),t.jsx("div",{className:"grid grid-cols-3 gap-1 max-h-32 overflow-y-auto",children:(()=>{const e=(new Date).getFullYear(),s=[];for(let t=e+5;t>=e-10;t--)s.push(t);return s.map(e=>t.jsx("button",{onClick:()=>{G(e),K(!1)},className:"px-2 py-1.5 text-xs rounded transition-all "+(X===e?"font-bold shadow-sm":"hover:bg-gray-100"),style:{backgroundColor:X===e?"var(--color-gold)":"transparent",color:X===e?"white":"#374151"},children:e},e))})()})]})]}),t.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:["S","M","T","W","T","F","S"].map((e,s)=>t.jsx("div",{className:"text-center text-xs font-semibold text-gray-500 bg-white rounded-md py-1",children:e},s))}),t.jsx("div",{className:"grid grid-cols-7 gap-1",children:i.map((s,r)=>{if(null===s)return t.jsx("div",{},r);const a=new Date(X,J,s),o=U&&new Date(U).toDateString()===a.toDateString(),n=e.toDateString()===a.toDateString();return t.jsx("button",{onClick:()=>{P(a.toISOString()),O("All Time")},className:`\n                                                                        aspect-square flex items-center justify-center text-xs rounded-md transition-all\n                                                                        ${o?"font-bold shadow-sm":"hover:bg-gray-200"}\n                                                                        ${n&&!o?"ring-1 ring-gray-400":""}\n                                                                    `,style:{backgroundColor:o?"var(--color-gold)":"transparent",color:o?"white":"#374151"},children:s},r)})})]})})()})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:r("Status",l)}),t.jsx("div",{className:"space-y-1.5",children:["All","Active","Completed"].map(e=>t.jsxs("button",{onClick:()=>z(e),className:"w-full text-left px-3 py-2 rounded-lg text-sm transition-all "+(F===e?"font-semibold":"text-gray-600 hover:bg-gray-50"),style:{backgroundColor:F===e?"var(--color-gold-light)":"transparent",color:F===e?"var(--color-gold)":"#4b5563"},children:[F===e&&t.jsx(j,{className:"w-4 h-4 inline mr-2"}),r(e,l)]},e))})]})]}),("All"!==_||U||"All"!==F)&&t.jsx("div",{className:"p-4 pt-3 border-t border-gray-100 bg-white sticky bottom-0",children:t.jsx("button",{onClick:()=>{B("All"),O("All Time"),z("All"),P(null)},className:"w-full py-2.5 rounded-lg text-sm font-semibold transition-all hover:opacity-90",style:{backgroundColor:"var(--color-gold)",color:"white"},children:r("Clear All Filters",l)})})]}),t.jsx("div",{className:"mt-2",children:p.trim()?t.jsxs("p",{className:"text-xs text-gray-500",children:["Showing ",Be.length," of ",be.length,' "',u,'" results for "',t.jsx("span",{className:"font-medium",children:p.trim()}),'"']}):t.jsxs("p",{className:"text-xs text-gray-400",children:[be.length," ",r(u,l)," ",r("requests",l).toLowerCase()]})})]}),t.jsx("div",{className:"flex overflow-x-scroll no-scrollbar px-4 space-x-2 pb-2",children:_e.map(({name:e,Icon:s})=>{const a=e===u;return t.jsxs("button",{style:(o=a,{backgroundColor:"transparent",color:o?"var(--color-gold)":"#6b7280",borderColor:o?"var(--color-gold)":"#d1d5db",boxShadow:o?"0 0 6px rgba(var(--color-gold-rgb), 0.25)":"none",textShadow:o?"0 0 6px rgba(var(--color-gold-rgb), 0.35)":"none",transition:"all .25s cubic-bezier(.4,0,.2,1)",fontWeight:o?"600":"500"}),className:`\n                                    flex items-center px-4 py-2 text-sm font-medium rounded-full\n                                    border whitespace-nowrap\n                                    ${a?"":"hover:bg-gray-100"}\n                                    active:scale-[.96]\n                                `,onClick:()=>g(e),onTouchEnd:()=>g(e),"aria-pressed":a,"aria-label":`Filter: ${e}`,children:[t.jsx(s,{className:"w-4 h-4 mr-1.5"}),r(e,l)]},e);var o})})]}),Le&&t.jsxs("div",{className:"fixed inset-0 z-[999] flex items-center justify-center px-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:Re}),t.jsxs("div",{className:"relative max-w-sm w-[90%] mx-auto",children:[t.jsx("style",{children:"\n                            @keyframes swipeLeftMove { \n                                0% { transform: translateX(24px) scale(1); opacity: 1; }\n                                60% { transform: translateX(-18px) scale(.98); opacity: .95; }\n                                100% { transform: translateX(-56px) scale(.94); opacity: 0; }\n                            }\n                            .swipe-hand { animation: swipeLeftMove 1.2s ease-in-out infinite; }\n                        "}),t.jsxs("div",{className:"bg-white rounded-2xl p-6 text-center shadow-2xl",children:[t.jsxs("div",{className:"flex items-center justify-center mb-4",children:[t.jsx("div",{className:"h-14 w-14 rounded-lg bg-gray-100 flex items-center justify-center mr-3 swipe-hand","aria-hidden":!0,children:t.jsx("div",{style:{width:20,height:20,borderRadius:4,background:"#111827"}})}),t.jsxs("svg",{className:"w-10 h-10 text-gray-400",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[t.jsx("path",{d:"M17 12H7",stroke:"#9CA3AF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:"M10 8l-4 4 4 4",stroke:"#9CA3AF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})]}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:r("Swipe left to remove a request",l)}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r("A left swipe clears the request from your feed. Bookmark it if you want to revisit it anytime.",l)}),t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{onClick:Re,className:"px-4 py-2 bg-gray-100 rounded-full font-semibold hover:bg-gray-200",style:{color:"var(--color-gold)"},children:r("Got it",l)})})]})]})]}),t.jsx("main",{className:"px-2 pt-4 max-w-lg mx-auto w-full",children:0===Be.length?t.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[t.jsx(w,{className:"w-10 h-10 text-gray-300 mb-4"}),t.jsx("p",{className:"text-sm font-semibold text-gray-700",children:r("No matches found",l)}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r("Try a different keyword or switch filters.",l)})]}):Be.map(e=>t.jsx("div",{"data-request-id":e.id,children:t.jsx(ne,{request:e,detailedRank:e,searchQuery:p,isPinned:!!e.pinned,onTogglePin:()=>{return t=e.id,void ve(e=>{const s=e.find(e=>e.id===t),r=!(s&&s.pinned),a=e.map(e=>e.id===t?{...e,pinned:!e.pinned,pinnedAt:e.pinned?null:Date.now()}:e),o=[...a.filter(e=>e.pinned).sort((e,t)=>(t.pinnedAt||0)-(e.pinnedAt||0)),...a.filter(e=>!e.pinned)];try{const e={};o.forEach(t=>{t.pinned&&(e[t.id]=t.pinnedAt)}),localStorage.setItem("pinned_requests_v1",JSON.stringify(e))}catch(n){}return setTimeout(()=>{if(r){try{const e=document.getElementById(`request-card-${t}`);e&&e.scrollIntoView({behavior:"smooth",block:"start"})}catch(n){}je({visible:!0,message:"Pinned"});try{fe(t),setTimeout(()=>fe(null),1200)}catch(n){}}else je({visible:!0,message:"Unpinned"})},120),o});var t},pulseActive:pe===e.id,isFocused:I&&String(e.id)===String(I),onOpenProfile:Ae,selectedLanguage:l,initialBookmarked:L.has(String(e.id)),adminSelections:ge,onBookmarkChange:(e,t)=>{$(s=>{const r=new Set(Array.from(s));return t?r.add(String(e)):r.delete(String(e)),r})}},e.id)},e.id))}),Z&&se&&t.jsx(V,{nudgeRequest:se,onClose:()=>te(!1),onBoostRequest:()=>{te(!1),setShowBoostsModal(!0)},onInviteFriends:()=>{te(!1),window.location.href="/requests?filter=For You"},selectedLanguage:l}),t.jsx(v,{selectedLanguage:l,activeTabOverride:"Requests"}),t.jsx(oe,{message:we.message,isVisible:we.visible,onClose:()=>je({visible:!1,message:""}),variant:"success",selectedLanguage:l}),Ne&&t.jsx(ie,{name:Se,username:Se,isCreator:qe,onClose:()=>{ke(!1),Ce(null),Te(!1),Ee(null)},profileData:Ie,selectedLanguage:l,onNavigateToIdeas:()=>{const e=Ie||{},t={id:e.id||(e.handle||e.tag||String(e.name||"").replace(/^@+/,"")).toLowerCase(),name:e.handle?`@${e.handle}`:e.name||"",handle:e.handle,image:e.image||null};window.localStorage.setItem("ideas_selectedCreator_v1",JSON.stringify(t)),ke(!1),Ce(null),Te(!1),Ee(null),window.dispatchEvent(new CustomEvent("ideas:creator_selected")),setTimeout(()=>{window.setFooterTab?(window.setFooterTab("ideas"),window.history.pushState({},"","/ideas")):window.location.href="/ideas"},50)}})]})}export{le as default};
