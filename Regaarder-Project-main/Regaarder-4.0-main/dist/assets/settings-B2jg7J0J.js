import{u as e,j as s,g as a,L as t,E as r,h as l}from"./index-Cuabw2cT.js";import{d as o,b as c}from"./vendor-Cml8jNaD.js";import{clearWatchHistory as n}from"./watchhistory-C7w-IkFS.js";import{C as i}from"./chevron-left-CtbPJiGe.js";import{D as d,T as m}from"./trash-CMZErkrn.js";import{M as x}from"./mail-B3G4IwI2.js";import{X as h}from"./x-MfhS-cbK.js";import"./config-DzyQUiLS.js";import"./SharedBottomBar-Deq-Xymt.js";import"./home-CBLh0DVW.js";import"./pencil-BVgSaJgM.js";import"./search-Z8bnC0pY.js";import"./history-C8hkE8vu.js";import"./lightbulb-vMj2a7hA.js";import"./check-circle-C0joXWRi.js";const u=(e,s="English")=>{if(!e)return a("Unknown",s);try{const s=new Date(e).getTime(),a=Date.now(),t=Math.max(0,a-s),r=Math.floor(t/6e4),l=Math.floor(r/60),o=Math.floor(l/24),c=Math.floor(o/30);return c>0?`${c} month${c>1?"s":""} ago`:o>0?`${o} day${o>1?"s":""} ago`:l>0?`${l} hour${l>1?"s":""} ago`:`${r} minute${1!==r?"s":""} ago`}catch{return a("Unknown",s)}},g=()=>{const g=e(),p=o(),[y]=c.useState(()=>{try{return localStorage.getItem("regaarder_language")||"English"}catch(e){return"English"}}),j=window&&window.__BACKEND_URL__||"https://pwin.onrender.com",f=(()=>{try{return g.user||JSON.parse(localStorage.getItem("regaarder_user")||"{}")}catch{return{}}})(),w=(()=>{try{return localStorage.getItem("regaarder_token")}catch{return null}})(),[b,v]=c.useState(!1),[N,C]=c.useState(!1),[k,S]=c.useState(!1),[_,D]=c.useState(!1),[E,P]=c.useState(""),[$,I]=c.useState(!1),[O,T]=c.useState(""),[B,J]=c.useState(!1),[L,z]=c.useState(""),[A,M]=c.useState(""),[R,U]=c.useState(""),[q,Y]=c.useState(f.email||""),[F,H]=c.useState(""),[G,K]=c.useState(!1),[Q,V]=c.useState(!1),[W,X]=c.useState(!1),[Z,ee]=c.useState(!1),[se,ae]=c.useState(!1),[te,re]=c.useState(""),le=["watchHistory","miniPlayerData","requested_badge_seen","requests_swipe_entrance_shown","pinned_requests_v1","publishedItems","videoplayer_index","videoplayer_source","handleHintShownQuickOptions","watchIncognito","hasSeenRequests","fab_dismissed","welcome_selected_role","requests_search_query","regaarder_push_enabled","regaarder_push_token","regaarder_push_history"];return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center",children:[s.jsxs("div",{className:"w-full max-w-xl min-h-screen flex flex-col",style:{paddingBottom:"calc(80px + env(safe-area-inset-bottom))"},children:[s.jsx("header",{className:"bg-white border-b border-gray-100 p-4 sticky top-0 z-20",style:{paddingTop:"calc(16px + env(safe-area-inset-top, 0px))"},children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(i,{className:"w-6 h-6 cursor-pointer transition active:scale-90",style:{color:"var(--color-gold)"},onClick:()=>{const e=localStorage.getItem("redirectBackTo");localStorage.removeItem("redirectBackTo"),p("creatorDashboard"===e?"/creatordashboard":"/home")}}),s.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:a("Settings",y)})]})}),s.jsxs("main",{className:"flex-grow p-4",children:[s.jsx("div",{className:"text-gray-900 text-lg font-semibold mb-3",children:a("Data & Account",y)}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden w-full max-w-md mx-auto mb-6",children:[s.jsx("button",{className:"w-full flex items-center justify-between px-4 py-4 hover:bg-gray-50 transition-colors",onClick:async()=>{try{const e=localStorage.getItem("regaarder_user"),s=e?JSON.parse(e):{},a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),r=document.createElement("a");r.href=t,r.download="regaarder-export.json",document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>{try{URL.revokeObjectURL(t)}catch(e){}},150)}catch(e){}},children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(d,{className:"w-6 h-6",style:{color:"var(--color-gold)"}}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-base font-medium text-gray-800",children:a("Export Your Data",y)}),s.jsx("div",{className:"text-sm text-gray-500",children:a("Download all your information",y)})]})]})}),s.jsx("div",{className:"h-px bg-gray-200 mx-4"}),s.jsx("button",{className:"w-full flex items-center justify-between px-4 py-4 hover:bg-gray-50 transition-colors",onClick:()=>{P(""),I(!1),S(!0)},children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(m,{className:"w-6 h-6",style:{color:"var(--color-gold)"}}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-base font-medium",style:{color:"var(--color-gold)"},children:a("Delete Your Data",y)}),s.jsx("div",{className:"text-sm text-gray-500",children:a("Delete all your data but keep your account",y)})]})]})}),s.jsx("div",{className:"h-px bg-gray-200 mx-4"}),s.jsx("button",{className:"w-full flex items-center justify-between px-4 py-4 hover:bg-gray-50 transition-colors",onClick:async()=>{if(window.confirm(a("Permanently delete your account?",y)))try{localStorage.removeItem("regaarder_user"),localStorage.removeItem("regaarder_token"),g&&g.logout&&g.logout(),p("/home")}catch(e){}},children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(m,{className:"w-6 h-6",style:{color:"var(--color-gold)"}}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-base font-medium",style:{color:"var(--color-gold)"},children:a("Delete Account",y)}),s.jsx("div",{className:"text-sm",style:{color:"var(--color-gold)"},children:a("Permanently delete your account",y)})]})]})})]}),s.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden w-full max-w-md mx-auto mb-4",children:s.jsxs("div",{className:"w-full flex items-center justify-between px-4 py-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(t,{className:"w-6 h-6",style:{color:"var(--color-gold)"}}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-base font-medium text-gray-800",children:a("Password",y)}),s.jsxs("div",{className:"text-sm text-gray-500",children:[a("Last changed",y)," ",u(f.passwordChangedAt,y)]})]})]}),s.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-gray-100 text-gray-800 text-sm font-semibold",onClick:()=>{re(""),v(!0)},children:a("Change",y)})]})}),s.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden w-full max-w-md mx-auto",children:s.jsxs("div",{className:"w-full flex items-center justify-between px-4 py-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(x,{className:"w-6 h-6",style:{color:"var(--color-gold)"}}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"text-base font-medium text-gray-800",children:a("Email",y)}),s.jsx("div",{className:"text-sm text-gray-500",children:f.email||"â€”"})]})]}),s.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-gray-100 text-gray-800 text-sm font-semibold",onClick:()=>{re(""),C(!0)},children:a("Change",y)})]})}),te&&s.jsx("div",{className:"max-w-md mx-auto mt-3 bg-red-50 text-red-700 text-sm rounded-lg px-4 py-2",children:te}),$&&s.jsx("div",{className:"max-w-md mx-auto mt-3 bg-green-50 text-green-700 text-sm rounded-lg px-4 py-2",children:a("Your data has been deleted",y)})]})]}),b&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{backgroundColor:"rgba(0,0,0,0.6)"},onClick:()=>v(!1),children:s.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{className:"w-5 h-5",style:{color:"var(--color-gold)"}}),s.jsx("div",{className:"text-lg font-semibold",children:a("Change Password",y)})]}),s.jsx("button",{onClick:()=>v(!1),className:"p-2 text-gray-500",children:s.jsx(h,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:G?"text":"password",placeholder:a("Current password",y),value:L,onChange:e=>z(e.target.value),className:"w-full pr-10 p-3 bg-gray-100 rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>K(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 p-1",children:G?s.jsx(r,{className:"w-5 h-5"}):s.jsx(l,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:Q?"text":"password",placeholder:a("New password",y),value:A,onChange:e=>M(e.target.value),className:"w-full pr-10 p-3 bg-gray-100 rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>V(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 p-1",children:Q?s.jsx(r,{className:"w-5 h-5"}):s.jsx(l,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:W?"text":"password",placeholder:a("Confirm new password",y),value:R,onChange:e=>U(e.target.value),className:"w-full pr-10 p-3 bg-gray-100 rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>X(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 p-1",children:W?s.jsx(r,{className:"w-5 h-5"}):s.jsx(l,{className:"w-5 h-5"})})]})]}),s.jsx("button",{disabled:se,onClick:async()=>{if(re(""),L&&A&&A===R){ae(!0);try{const e=await fetch(`${j}/me/password`,{method:"POST",headers:{"Content-Type":"application/json",...w?{Authorization:`Bearer ${w}`}:{}},body:JSON.stringify({currentPassword:L,newPassword:A})}),s=await e.json();if(!e.ok)throw new Error(s.error||"Failed");try{localStorage.setItem("regaarder_user",JSON.stringify(s.user))}catch{}g&&g.login&&g.login({...s.user,token:w}),v(!1),z(""),M(""),U("")}catch(e){re(e.message||"Error")}finally{ae(!1)}}else re("Please fill all fields correctly")},className:"mt-4 w-full py-3 rounded-lg text-black font-semibold "+(se?"opacity-60":""),style:{backgroundColor:"var(--color-gold)"},children:a(se?"Saving...":"Save",y)})]})}),N&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{backgroundColor:"rgba(0,0,0,0.6)"},onClick:()=>C(!1),children:s.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(x,{className:"w-5 h-5",style:{color:"var(--color-gold)"}}),s.jsx("div",{className:"text-lg font-semibold",children:a("Change Email",y)})]}),s.jsx("button",{onClick:()=>C(!1),className:"p-2 text-gray-500",children:s.jsx(h,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("input",{type:"email",placeholder:a("New email",y),value:q,onChange:e=>Y(e.target.value),className:"w-full p-3 bg-gray-100 rounded-lg"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:Z?"text":"password",placeholder:a("Current password",y),value:F,onChange:e=>H(e.target.value),className:"w-full pr-10 p-3 bg-gray-100 rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>ee(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 p-1",children:Z?s.jsx(r,{className:"w-5 h-5"}):s.jsx(l,{className:"w-5 h-5"})})]})]}),s.jsx("button",{disabled:se,onClick:async()=>{if(re(""),q&&F){ae(!0);try{const e=await fetch(`${j}/me/email`,{method:"POST",headers:{"Content-Type":"application/json",...w?{Authorization:`Bearer ${w}`}:{}},body:JSON.stringify({newEmail:q,currentPassword:F})}),s=await e.json();if(!e.ok)throw new Error(s.error||"Failed");try{localStorage.setItem("regaarder_user",JSON.stringify(s.user))}catch{}g&&g.login&&g.login({...s.user,token:w}),C(!1),H("")}catch(e){re(e.message||"Error")}finally{ae(!1)}}else re("Please fill all fields")},className:"mt-4 w-full py-3 rounded-lg text-black font-semibold "+(se?"opacity-60":""),style:{backgroundColor:"var(--color-gold)"},children:a(se?"Saving...":"Save",y)})]})}),k&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{backgroundColor:"rgba(0,0,0,0.6)"},onClick:()=>S(!1),children:s.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md p-6",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"text-lg font-semibold",children:a("Delete Your Data",y)}),s.jsx("button",{onClick:()=>S(!1),className:"p-2 text-gray-500",children:s.jsx(h,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"text-sm text-gray-700 mb-4",children:a("Delete all your data but keep your account",y)}),s.jsx("div",{className:"mb-3 text-sm text-gray-600",children:a("Please re-enter your password to confirm deleting your data",y)}),s.jsx("div",{className:"mb-3",children:s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:B?"text":"password",placeholder:a("Current password",y),value:O,onChange:e=>T(e.target.value),className:"w-full pr-10 p-3 bg-gray-100 rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>J(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 p-1",children:B?s.jsx(r,{className:"w-5 h-5"}):s.jsx(l,{className:"w-5 h-5"})})]})}),E&&s.jsx("div",{className:"text-sm text-red-600 mb-3",children:E}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>{S(!1),T("")},className:"flex-1 py-2 rounded-lg border border-gray-200",children:a("Cancel",y)}),s.jsx("button",{disabled:_||!O,onClick:async()=>{P(""),D(!0);try{if(w){const e=await fetch(`${j}/me/data`,{method:"DELETE",headers:{"Content-Type":"application/json",...w?{Authorization:`Bearer ${w}`}:{}},body:JSON.stringify({currentPassword:O})});if(!e.ok){const s=await e.json().catch(()=>({}));throw new Error(s.error||"Failed to delete data on server")}}try{try{n()}catch(e){}le.forEach(s=>{try{localStorage.removeItem(s)}catch(e){}})}catch(e){}I(!0),S(!1)}catch(e){P(e.message||"Error")}finally{D(!1)}},className:"flex-1 py-2 rounded-lg text-white "+(_||!O?"opacity-60":""),style:{backgroundColor:"var(--color-gold)"},children:a(_?"Deleting...":"Delete My Data",y)})]})]})})]})};export{g as default};
